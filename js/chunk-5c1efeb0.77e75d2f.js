(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5c1efeb0","chunk-2d0c4a90"],{"3c7a":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{message:"",visible:this.visible.show,width:950,destroyOnClose:!0,closable:!1},on:{close:t.onClose}},[a("template",{slot:"title"},[t._v("\n    客户明细\n  ")]),a("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,pagination:!1,rowKey:"ComProductLineGuid"},scopedSlots:t._u([{key:"CreatDate",fn:function(e,o){return a("span",{staticStyle:{"text-align":"right"}},[""!=o.PullTime?[t._v(t._s(o.PullTime))]:t._e(),""==o.PullTime?[t._v(t._s(o.CreatDate))]:t._e()],2)}},{key:"isOperate",fn:function(e,o){return a("span",{staticStyle:{"text-align":"right"}},[a("a-tag",{attrs:{color:1==o.Opened?"red":0==o.Cooperated?"blue":1==o.Cooperated?"green":""}},[1==o.Opened?[t._v("公海")]:t._e(),0==o.Opened?[t._v(t._s(o.CooperatedText))]:t._e()],2)],1)}},{key:"CityCode",fn:function(e,o){return a("span",{staticStyle:{"text-align":"right"}},[t._v("\n          "+t._s(t.cityList[o.CityCode])+"\n        ")])}}])},[a("template",{slot:"footer"},[a("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:t.formSearch.pageSize,total:t.formSearch.total,current:t.formSearch.current},on:{change:t.pagechange}})],1)],2),a("a-row",{staticStyle:{padding:"10px 0"},attrs:{gutter:24}})],2)},r=[],n=(a("8e6e"),a("ac6a"),a("456d"),a("bd86")),i=a("b775"),c=a("c32d"),s=a.n(c);function l(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,o)}return a}function u(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?l(a,!0).forEach(function(e){Object(n["a"])(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):l(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var d=[{title:"是否合作",scopedSlots:{customRender:"isOperate"}},{title:"公司名称",dataIndex:"ComName"},{title:"产品线",dataIndex:"ProductLineText"},{title:"城市",scopedSlots:{customRender:"CityCode"}},{title:"归属人",dataIndex:"UseridText"},{title:"入库时间",dataIndex:"PullTime"}],p={components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{columns:d,visible:{show:!1,pFormSearch:{},SaleStage:""},formSearch:{pageSize:10,current:1,total:0},form:this.$form.createForm(this),drawer:{},modal:{},cityList:{},moment:s.a,dataSource:[]}},created:function(){var t=this;this.$watch("show",function(e,a){t.visible=e,console.log(t.visible),t.visible.show&&(t.formSearch=u({pageSize:10,total:0},t.visible.pFormSearch),console.log(t.formSearch),t.init())})},methods:{init:function(){var t=this;t.initPage()},onClose:function(){this.visible.show=!1,this.dataSource=[],this.refresh&&this.refresh()},initPage:function(){this.pagechange(1)},pagerefresh:function(){this.pagechange(this.formSearch.current)},pagechange:function(t){var e=this,a={};e.formSearch.current=t,a.ProductLine=e.formSearch.ProductLine,a.current=e.formSearch.current,a.pageSize=e.formSearch.pageSize,a.Begin=e.formSearch.Begin,a.End=e.formSearch.End,a.SaleStage=e.visible.SaleStage,e.$loading.open(),i["a"].post("/api/Crm/Data/SalesFunnelSelfDetail",a).then(function(t){e.$loading.close(),0===t.code&&(e.dataSource=t.data.rows,e.formSearch.total=t.data.count)}).catch(function(t){e.$loading.close(),console.log(t)})}}},f=p,h=a("2877"),m=Object(h["a"])(f,o,r,!1,null,null,null);e["default"]=m.exports},"45aa":function(t,e,a){"use strict";a.r(e);var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-layout",[a("a-layout-content",[a("a-card",{attrs:{bordered:!1}},[a("div",[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:t.advanced?null:"fold"},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{md:4}},[a("a-form-item",{attrs:{label:"产品线",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-select",{attrs:{placeholder:"请选择",allowClear:!0},model:{value:t.formSearch.ProductLine,callback:function(e){t.$set(t.formSearch,"ProductLine",e)},expression:"formSearch.ProductLine"}},t._l(t.ComProductLine,function(e){return a("a-select-option",{key:e.key},[t._v(t._s(e.text))])}),1)],1)],1),a("a-col",{attrs:{md:4}},[a("a-form-item",{attrs:{label:"开始时间",labelCol:{span:7},wrapperCol:{span:17}}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"},model:{value:t.formSearch.Begin,callback:function(e){t.$set(t.formSearch,"Begin",e)},expression:"formSearch.Begin"}})],1)],1),a("a-col",{attrs:{md:4}},[a("a-form-item",{attrs:{label:"结束时间",labelCol:{span:7},wrapperCol:{span:17}}},[a("a-date-picker",{staticStyle:{width:"100%"},attrs:{format:"YYYY-MM-DD"},model:{value:t.formSearch.End,callback:function(e){t.$set(t.formSearch,"End",e)},expression:"formSearch.End"}})],1)],1),a("a-col",{attrs:{span:3}},[a("a-form-item",[a("a-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:t.initPage}},[t._v("查询")])],1)],1)],1)],1)])],1),a("a-row",[a("a-col",{attrs:{span:9}},[a("v-chart",{attrs:{"force-fit":!0,height:t.height,padding:t.padding,data:t.data,scale:t.scale}},[a("v-tooltip",{attrs:{"show-title":!1,"item-tpl":t.tooltipOpts.itemTpl}}),a("v-legend"),a("v-coord",{attrs:{type:"rect",direction:"LT"}}),a("v-pyramid",{attrs:{position:t.funnelOpts.position,color:t.funnelOpts.color,label:t.funnelOpts.label,tooltip:t.funnelOpts.tooltip}}),t._l(t.data,function(e,o){return a("v-guide",{key:o,attrs:{type:"text",top:!0,position:t.getPosition(e),content:t.getContent(e),vStyle:t.style}})})],2)],1),a("a-col",{attrs:{span:15}},[a("a-table",{attrs:{columns:t.columns,dataSource:t.contractList,pagination:!1,rowKey:"SaleStage"},scopedSlots:t._u([{key:"num",fn:function(e,o){return a("span",{staticStyle:{"text-align":"right"}},[a("a",{on:{click:function(e){return t.detail(o)}}},[t._v(t._s(o["现存"]))])])}}])})],1)],1)],1)],1),a("drawer-detail",{attrs:{show:t.drawer.detail,refresh:t.pagerefresh}})],1)},r=[],n=(a("8e6e"),a("456d"),a("bd86")),i=(a("ac6a"),a("b775")),c=a("c32d"),s=a.n(c),l=a("3c7a");function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,o)}return a}function d(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(a,!0).forEach(function(e){Object(n["a"])(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}var p=a("7104"),f=[],h={dataKey:"percent",nice:!1},m=(new p.View).source(f);m.transform({type:"percent",field:"Status",dimension:"action",as:"percent"});var g=m.rows,S={showTitle:!1,itemTpl:'<li data-index={index} style="margin-bottom:4px;"><span style="background-color:{color};" class="g2-tooltip-marker"></span>{name}<br/><span style="padding-left: 16px">数量：{Status}</span><br/><span style="padding-left: 16px">占比：{percent}</span><br/></li>'},y={position:"action*percent",color:["action",["#0050B3","#1890FF","#40A9FF","#69C0FF","#BAE7FF"]],label:["action*Status",function(t,e){return t+" "+e},{offset:35,labelLine:{lineWidth:1,stroke:"rgba(0, 0, 0, 0.15)"}}],tooltip:["action*Status*percent",function(t,e,a){return{name:t,percent:Math.floor(100*a)+"%",Status:e}}]},b=[{title:"销售阶段",dataIndex:"类型"},{title:"现数量",scopedSlots:{customRender:"num"}},{title:"转化率",dataIndex:"转化率"},{title:"数量汇总",dataIndex:"总计"}],w={components:{DrawerDetail:l["default"]},data:function(){return{advanced:!0,columns:b,sourceData:f,formSearch:{ProductLine:""},form:this.$form.createForm(this),contractList:[],roles:[],drawer:{detail:{show:!1}},modal:{},invalidlayer:!1,confirmLoading:!1,invalidRecord:{},status:[],ContractResult:[],PayDaySuffix:{},User:{},Dept:{},moment:s.a,comRankObject:{},rolesmanager:!1,data:g,padding:[50,120,95],scale:h,height:350,tooltipOpts:S,funnelOpts:y,style:{fill:"#fff",fontSize:"12",textAlign:"center",shadowBlur:2,shadowColor:"rgba(0, 0, 0, .45)"},dv:m,ComProductLine:[]}},mounted:function(){var t=this;t.init()},methods:{init:function(){var t=this;i["a"].post("/api/Dim/Enum/GetEnum",{Names:["ContractStatus","ContractResult","PayDaySuffix","ComRankNormal","ComProductLine"]}).then(function(e){0===e.code&&(t.status=e.data.ContractStatus,t.ContractResult=e.data.ContractResult,t.ComProductLine=e.data.ComProductLine,e.data.PayDaySuffix.forEach(function(e,a){t.PayDaySuffix[e.key]=e.text}),e.data.ComRankNormal.forEach(function(e,a){t.comRankObject[e.key]=e.text}))}).catch(function(t){console.log(t)}),i["a"].post("/api/Dim/Enum/DimDecode",{Names:["User","Dept"]}).then(function(e){t.$loading.close(),0===e.code&&(t.User=e.data.User,t.Dept=e.data.Dept)}).catch(function(e){t.$loading.close(),console.log(e)}),this.pagechange(1)},initPage:function(){this.pagechange(1)},pagerefresh:function(){this.pagechange(this.formSearch.current)},pagechange:function(t){var e=this,a=d({},e.formSearch);e.formSearch.current=t,e.form.validateFields(function(t,o){t||(e.$loading.open(),i["a"].post("/api/Crm/Data/SalesFunnelSelf",a).then(function(t){if(e.$loading.close(),0===t.code){e.contractList=t.data.rows,e.data=[],t.data.rows.forEach(function(t,a){var o={action:t["类型"],Status:t["现存"]};e.data.push(o)});var a=(new p.View).source(e.data);a.transform({type:"percent",field:"Status",dimension:"action",as:"percent"}),console.log(a),e.data=a.rows,console.log(e.data)}}).catch(function(t){e.$loading.close(),console.log(t)}))})},detail:function(t){var e=this;this.drawer.detail={show:!0,pFormSearch:e.formSearch,SaleStage:t.SaleStage}},statusChange:function(t){this.formSearch.Result=40==t?10:""},getPosition:function(t){return{action:t.action,percent:"median"}},getContent:function(t){return parseInt(String(100*t.percent))+"%"}}},v=w,O=a("2877"),C=Object(O["a"])(v,o,r,!1,null,null,null);e["default"]=C.exports}}]);