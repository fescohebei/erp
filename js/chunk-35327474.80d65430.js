(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-35327474","chunk-2d0c91b2","chunk-2d0ac941"],{"19ad":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-drawer",{attrs:{message:"",visible:this.visible.show,width:500,destroyOnClose:!0,closable:!1},on:{close:t.onClose}},[n("template",{slot:"title"},[t._v("\n    详情\n  ")]),n("a-table",{attrs:{columns:t.columns,dataSource:t.peopleList,pagination:!1,rowKey:"ComGuid"},scopedSlots:t._u([{key:"Userid",fn:function(e,a){return n("span",{staticStyle:{"text-align":"right"}},[t._v("\n          "+t._s(t.UserArray[a.Userid])+"\n        ")])}},{key:"ProductLine",fn:function(e,a){return n("span",{staticStyle:{"text-align":"right"}},[t._v("\n          "+t._s(t.visible.ProductLine[a.ProductLine])+"\n        ")])}}])},[n("template",{slot:"footer"},[n("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:t.formSearch.pageSize,total:t.formSearch.total,current:t.formSearch.current},on:{change:t.pagechange}})],1)],2)],2)},o=[],r=n("b775"),i=(n("c32d"),[{title:"公司名称",dataIndex:"ComName",width:150}]),s={components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,id:{},assetsdetail:{},ProductLine:{}},columns:i,formSearch:{pageSize:10,current:1,total:0,Userid:"",Begin:"",End:""},form:this.$form.createForm(this),drawer:{},modal:{},peopleList:[]}},created:function(){var t=this;this.$watch("show",function(e,n){t.visible=e,console.log(t.visible),t.visible.show&&t.init()})},methods:{init:function(){var t=this;t.pagechange(1)},pagechange:function(t){var e=this,n=e.formSearch;e.formSearch.current=t,e.formSearch.Userid=e.visible.assetsdetail.Userid,e.formSearch.Begin=e.visible.Begin,e.formSearch.End=e.visible.End,r["a"].post("/api/Crm/Data/ContactRecordsComDetailByUser",n).then(function(t){0===t.code&&(e.peopleList=t.data.rows,e.formSearch.total=t.count)}).catch(function(t){console.log(t)})},onClose:function(){this.visible.show=!1,this.refresh&&this.refresh()}}},c=s,l=n("2877"),d=Object(l["a"])(c,a,o,!1,null,null,null);e["default"]=d.exports},"1af6":function(t,e,n){var a=n("63b6");a(a.S,"Array",{isArray:n("9003")})},5870:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-drawer",{attrs:{message:"",visible:this.visible.show,width:850,destroyOnClose:!0,closable:!1},on:{close:t.onClose}},[n("template",{slot:"title"},[t._v("\n    详情\n  ")]),n("a-table",{attrs:{columns:t.columns,dataSource:t.peopleList,pagination:!1,rowKey:"ContactRecordGuid"},scopedSlots:t._u([{key:"Userid",fn:function(e,a){return n("span",{staticStyle:{"text-align":"right"}},[t._v("\n          "+t._s(t.UserArray[a.Userid])+"\n        ")])}},{key:"ProductLine",fn:function(e,a){return n("span",{staticStyle:{"text-align":"right"}},[t._v("\n          "+t._s(t.visible.ProductLine[a.ProductLine])+"\n        ")])}}])},[n("template",{slot:"footer"},[n("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:t.formSearch.pageSize,total:t.formSearch.total,current:t.formSearch.current},on:{change:t.pagechange}})],1)],2)],2)},o=[],r=n("b775"),i=(n("c32d"),[{title:"公司名称",dataIndex:"ComName",width:150},{title:"产品线",scopedSlots:{customRender:"ProductLine"},width:150},{title:"联系时间",dataIndex:"Contacttime",width:150},{title:"沟通内容",dataIndex:"ContactContent"}]),s={components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,id:{},assetsdetail:{},ProductLine:{}},columns:i,formSearch:{pageSize:10,current:1,total:0,Userid:"",Begin:"",End:""},form:this.$form.createForm(this),drawer:{},modal:{},peopleList:[]}},created:function(){var t=this;this.$watch("show",function(e,n){t.visible=e,console.log(t.visible),t.visible.show&&t.init()})},methods:{init:function(){var t=this;t.pagechange(1)},pagechange:function(t){var e=this,n=e.formSearch;e.formSearch.current=t,e.formSearch.Userid=e.visible.assetsdetail.Userid,e.formSearch.Begin=e.visible.Begin,e.formSearch.End=e.visible.End,r["a"].post("/api/Crm/Data/ContactRecordsDetailByUser",n).then(function(t){0===t.code&&(e.peopleList=t.data.rows,e.formSearch.total=t.count)}).catch(function(t){console.log(t)})},onClose:function(){this.visible.show=!1,this.refresh&&this.refresh()}}},c=s,l=n("2877"),d=Object(l["a"])(c,a,o,!1,null,null,null);e["default"]=d.exports},"739c":function(t,e,n){"use strict";var a=n("e395"),o=n.n(a);o.a},"75fc":function(t,e,n){"use strict";var a=n("a745"),o=n.n(a);function r(t){if(o()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var i=n("774e"),s=n.n(i),c=n("c8bb"),l=n.n(c);function d(t){if(l()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return s()(t)}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){return r(t)||d(t)||u()}n.d(e,"a",function(){return f})},"774e":function(t,e,n){t.exports=n("d2d5")},a745:function(t,e,n){t.exports=n("f410")},c8bb:function(t,e,n){t.exports=n("54a1")},e395:function(t,e,n){},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},f577:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("a-layout",[n("a-layout-content",[n("a-card",{attrs:{bordered:!1}},[n("div",[n("a-form",{attrs:{form:t.form,layout:"horizontal"}},[n("div",{class:t.advanced?null:"fold"},[n("a-row",{attrs:{gutter:10}},[t.roles87?n("a-col",{attrs:{md:4}},[n("a-form-item",{attrs:{label:"部门",labelCol:{span:6},wrapperCol:{span:18}}},[n("a-cascader",{directives:[{name:"decorator",rawName:"v-decorator",value:["DepId"],expression:"['DepId']"}],attrs:{options:t.options,loadData:t.loadData,changeOnSelect:"",placeholder:"请选择部门"}})],1)],1):t._e(),n("a-col",{attrs:{md:7}},[n("a-form-item",{attrs:{label:"时间",labelCol:{span:4},wrapperCol:{span:20}}},[n("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["Time"],expression:"['Time']"}],attrs:{format:"YYYY-MM-DD"}})],1)],1),n("a-col",{attrs:{span:12}},[n("a-form-item",[n("a-button",{attrs:{type:"primary"},on:{click:t.initPage}},[t._v("查询")])],1)],1)],1)],1)])],1),n("a-table",{attrs:{columns:t.columns,dataSource:t.allConnectList,pagination:!1,rowKey:"Userid"},scopedSlots:t._u([{key:"Userid",fn:function(e,a){return n("span",{staticStyle:{"text-align":"right"}},[t._v("\n          "+t._s(t.UserArray[a.Userid])+"\n        ")])}},{key:"countRecord",fn:function(e,a){return n("span",{staticStyle:{"text-align":"right"}},[a.countRecord?[n("a",{on:{click:function(e){return t.detail(a)}}},[t._v(t._s(a.countRecord))])]:[t._v("\n            0\n          ")]],2)}},{key:"countComs",fn:function(e,a){return n("span",{staticStyle:{"text-align":"right"}},[a.countComs?[n("a",{on:{click:function(e){return t.detailComs(a)}}},[t._v(t._s(a.countComs))])]:[t._v("\n            0\n          ")]],2)}}])})],1)],1),n("drawer-detail",{attrs:{show:t.drawer.detail,refresh:t.pagerefresh}}),n("drawer-detail-coms",{attrs:{show:t.drawer.detailcoms,refresh:t.pagerefresh}})],1)},o=[],r=n("75fc"),i=(n("7f7f"),n("ac6a"),n("b775")),s=n("c32d"),c=n.n(s),l=n("5870"),d=n("19ad"),u=[{title:"销售姓名",scopedSlots:{customRender:"Userid"}},{title:"沟通次数",scopedSlots:{customRender:"countRecord"}},{title:"客户数量",scopedSlots:{customRender:"countComs"}}],f={components:{DrawerDetail:l["default"],DrawerDetailComs:d["default"]},data:function(){return{advanced:!0,columns:u,formSearch:{DepId:"",Begin:"",End:""},form:this.$form.createForm(this),allConnectList:[],roles:[],drawer:{detail:{show:!1},detailcoms:{show:!1}},modal:{exporttransfer:{show:!1}},invalidlayer:!1,confirmLoading:!1,invalidRecord:{},status:[],ContractResult:[],PayDaySuffix:{},options:[],moment:c.a,UserArray:[],DeptArray:[],ProductLine:[],roles87:!1}},mounted:function(){var t=this;t.init()},methods:{init:function(){var t=this;i["a"].post("/api/Dim/Enum/DimDecode",{Names:["User","Dept"]}).then(function(e){0===e.code&&(t.UserArray=e.data.User,t.DeptArray=e.data.Dept)}).catch(function(t){console.log(t)}),i["a"].post("/api/Dim/Enum/GetEnum",{Names:["ComProductLine"]}).then(function(e){0===e.code&&e.data.ComProductLine.forEach(function(e,n){t.ProductLine[e.key]=e.text})}).catch(function(t){console.log(t)}),i["a"].get("/api/Org/User/CurrentUsersRole").then(function(e){0===e.code&&e.data.forEach(function(e,n){"87"==e&&(t.roles87=!0,t.getDep())})}).catch(function(t){console.log(t)})},initPage:function(){this.pagechange(1)},pagerefresh:function(){this.pagechange(this.formSearch.current)},pagechange:function(t){var e=this,n=e.formSearch;e.formSearch.current=t,e.form.validateFields(function(t,a){if(!t){if(e.roles87&&!a.DepId)return void e.$message.error("请选择部门！");if(!a.Time||a.Time.length<1)return void e.$message.error("请选择时间！");e.roles87&&(e.formSearch.DepId=a.DepId[a.DepId.length-1]),e.$loading.open(),e.formSearch.Begin=c()(a.Time[0]._d).format("YYYY-MM-DD"),e.formSearch.End=c()(a.Time[1]._d).format("YYYY-MM-DD"),i["a"].post("/api/Crm/Data/ContactRecordsCountByDept",n).then(function(t){e.$loading.close(),0===t.code&&(e.formSearch.total=t.count,e.allConnectList=t.data)}).catch(function(t){e.$loading.close(),console.log(t)})}})},detail:function(t){this.drawer.detail={show:!0,assetsdetail:t,Begin:this.formSearch.Begin,End:this.formSearch.End,ProductLine:this.ProductLine}},detailComs:function(t){this.drawer.detailcoms={show:!0,assetsdetail:t,Begin:this.formSearch.Begin,End:this.formSearch.End,ProductLine:this.ProductLine}},statusChange:function(t){this.formSearch.Result=40==t?10:""},getDep:function(){var t=this;i["a"].get("/api/Org/Department/DepsByCurUser").then(function(e){0===e.code&&e.data.forEach(function(e,n){var a={};a.value=e.code,a.label=e.name,a.isLeaf=!1,t.options.push(a)})}).catch(function(t){console.log(t)})},loadData:function(t){var e=t[t.length-1],n=this;e.loading=!0,i["a"].post("/api/Org/Department/ChildrenDepsByDepId",{DepId:e.value}).then(function(t){e.loading=!1,0===t.code&&(t.data.length>0?(e.children=[],t.data.forEach(function(t,n){var a={};a.value=t.code,a.label=t.name,a.isLeaf=!1,e.children.push(a)}),n.options=Object(r["a"])(n.options)):(e.isLeaf=!0,e.loading=!1,n.options=Object(r["a"])(n.options)))}).catch(function(t){console.log(t),e.loading=!1})}}},h=f,m=(n("739c"),n("2877")),p=Object(m["a"])(h,a,o,!1,null,null,null);e["default"]=p.exports}}]);