(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8339ec7c"],{"0bfb":function(t,e,i){"use strict";var a=i("cb7c");t.exports=function(){var t=a(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},3846:function(t,e,i){i("9e1e")&&"g"!=/./g.flags&&i("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:i("0bfb")})},"39b9":function(t,e,i){"use strict";var a=i("e81a"),o=i.n(a);o.a},"6b54":function(t,e,i){"use strict";i("3846");var a=i("cb7c"),o=i("0bfb"),n=i("9e1e"),l="toString",r=/./[l],s=function(t){i("2aba")(RegExp.prototype,l,t,!0)};i("79e5")(function(){return"/a/b"!=r.call({source:"a",flags:"b"})})?s(function(){var t=a(this);return"/".concat(t.source,"/","flags"in t?t.flags:!n&&t instanceof RegExp?o.call(t):void 0)}):r.name!=l&&s(function(){return r.call(this)})},c946:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("a-drawer",{attrs:{title:t.visible.title,visible:this.visible.show,width:400,destroyOnClose:!0},on:{close:t.onClose}},[i("a-form",{attrs:{form:t.form,layout:"horizontal"}},[i("a-row",{attrs:{gutter:11}},[i("a-col",{attrs:{md:24}},[null!=t.cuiShouDetail?[i("a-row",{attrs:{gutter:10}},[i("a-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[t._v("客服:")]),i("a-col",{attrs:{span:19}},[t._v(t._s(t.visible.UserArray[t.cuiShouDetail.Userid])+" ")])],1),i("a-row",{attrs:{gutter:10}},[i("a-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[t._v("操作时间:")]),i("a-col",{attrs:{span:19}},[t._v(t._s(t.cuiShouDetail.CreateDate)+" ")])],1),i("a-row",{attrs:{gutter:10}},[i("a-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[t._v("说明:")]),i("a-col",{attrs:{span:19}},[t._v(t._s(t.cuiShouDetail.Explain)+" ")])],1),i("a-row",{attrs:{gutter:10}},[i("a-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[t._v("附件:")]),i("a-col",{attrs:{span:19}},[1==t.notInDingTalk?i("div",[i("a-tag",{attrs:{color:"red"}},[t._v("此浏览器不支持预览，请到钉钉应用界面预览附件！")])],1):null==!t.cuiShouDetail.kfUpload?i("div",[t._v("无")]):[t._l(t.cuiShouDetail.kfUpload,function(e,a){return[i("div",{key:a,staticClass:"fujian"},[t._v("\n                      "+t._s(e.fileName)+" "),i("a-tag",{attrs:{color:"blue"},on:{click:function(i){return t.showFile(e)}}},[t._v("预览")])],1)]})]],2)],1)]:t._e(),i("a-form-item",{attrs:{label:"附件",labelCol:{span:4},wrapperCol:{span:20}}},[i("a-button",{attrs:{disabled:1==t.notInDingTalk&&"disabled"},on:{click:t.uploadFile}},[i("a-icon",{attrs:{type:"upload"}}),t._v(" 上传附件")],1),1==t.notInDingTalk?i("div",[i("a-tag",{attrs:{color:"red"}},[t._v("此浏览器不支持上传，请到钉钉应用界面上传附件！")])],1):t._e(),t._l(t.uploadArry,function(e){return i("div",{key:e.fileId},[i("a-icon",{attrs:{type:"file-text"}}),t._v(" "+t._s(e.fileName)+"  "),i("a-icon",{staticStyle:{cursor:"pointer",color:"#1890ff"},attrs:{type:"search"},on:{click:function(i){return t.showFile(e)}}}),t._v("  "),i("a-icon",{staticStyle:{cursor:"pointer",color:"#1890ff"},attrs:{type:"delete"},on:{click:function(i){return t.deleteFile(e.fileId)}}})],1)})],2),i("a-form-item",{attrs:{label:"说明",labelCol:{span:4},wrapperCol:{span:20}}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Explain",{rules:t.AFormImportRules.Explain}],expression:"['Explain',{rules:AFormImportRules.Explain}]"}],attrs:{placeholder:"说明",rows:4}})],1)],2)],1)],1),i("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px","z-index":9}},[i("a-button",{on:{click:t.onClose}},[t._v("取消")]),i("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:function(e){return t.handleSubmit()}}},[t._v("立即提交")])],1)],1)},o=[],n=(i("ac6a"),i("6b54"),i("b775")),l={props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{spinning:!1,visible:{show:!1,title:"",ReceiptType:"",BankList:[],detail:{},UserArray:{}},form:this.$form.createForm(this),AFormImportRules:{Explain:[{required:!0,message:"请输入"}]},receivedtype:{ReceiptType:""},errdatarows:[],fileDis:!0,fileList:[],previewVisible:!1,previewImage:"",notInDingTalk:!1,uploadArry:[],SpaceId:"",SpaceIdNormal:"",cuiShouDetail:{}}},created:function(){var t=this;this.$watch("show",function(e,i){t.visible=e,t.spinning=!1,t.init()})},methods:{onClose:function(){this.visible.show=!1,this.receivedtype={ReceiptType:""},this.fileDis=!0,this.uploadArry=[],this.cuiShouDetail={},this.refresh&&this.refresh()},init:function(){var t=this;n["a"].post("/api/Bill/Urge/Detail",{BillGuid:t.visible.detail.BillGuid}).then(function(e){t.cuiShouDetail=e.data.DuiZhang,t.cuiShouDetail&&(t.cuiShouDetail.kfUpload=t.cuiShouDetail["附件"]?JSON.parse(t.cuiShouDetail["附件"]):[],t.cuiShouDetail.zkUpload=t.cuiShouDetail["质控附件"]?JSON.parse(t.cuiShouDetail["质控附件"]):[])}).catch(function(t){console.log(t)}),n["a"].post("/api/DingTalk/GrantCustomSpaceAdd",{domain:"Bill"}).then(function(t){}).catch(function(t){console.log(t)}),n["a"].post("/api/DingTalk/GetCustomSpace",{Domain:"Bill"}).then(function(e){var i=e,a=i.data.Spaceid;0===i.code&&(t.SpaceIdNormal=a)}).catch(function(t){console.log(t)}),n["a"].post("/api/DingTalk/GetSign",{}).then(function(e){t.fescoMessage=e.data,dd.config({agentId:e.data.AgentId,corpId:e.data.corpId,timeStamp:e.data.timeStamp,nonceStr:e.data.nonceStr,signature:e.data.signature,type:0,jsApiList:["biz.cspace.saveFile","biz.util.uploadAttachment","biz.cspace.preview","biz.cspace.chooseSpaceDir"]})}).catch(function(t){console.log(t)}),"notInDingTalk"==dd.env.platform&&(this.notInDingTalk=!0)},uploadFile:function(){var t=this,e="";dd.ready(function(){e=t.SpaceIdNormal,dd.biz.util.uploadAttachment({image:{multiple:!0,compress:!1,max:9,spaceId:e.toString()},space:{corpId:t.fescoMessage.corpId,spaceId:e.toString(),max:9},file:{spaceId:e.toString(),max:9},types:["file"],onSuccess:function(e){t.uploadArry=t.uploadArry.concat(e.data),n["a"].post("/api/DingTalk/GrantCustomSpaceDownload",{Domain:"Bill",Files:t.uploadArry}).then(function(t){}).catch(function(t){console.log(t)})},onFail:function(t){}})})},showFile:function(t){console.log(t);var e=this,i="";dd.ready(function(){i=e.SpaceIdNormal,dd.biz.cspace.preview({corpId:e.fescoMessage.corpId,spaceId:i.toString(),fileId:t.fileId,fileName:t.fileName,fileSize:t.fileSize,fileType:t.fileType,onSuccess:function(){},onFail:function(t){}})})},deleteFile:function(t){var e=this;this.uploadArry.forEach(function(i,a){i.fileId===t&&e.uploadArry.splice(a,1)})},handleSubmit:function(t){var e=this,i=this;this.form.validateFields(function(t,a){if(!t){if(!i.uploadArry.length)return void e.$message.error("请上传附件！");var o={BillGuid:e.visible.detail.BillGuid,Explain:a.Explain,"附件":i.uploadArry};i.submitCallback("/api/Bill/Urge/DuiZhang",o)}})},submitCallback:function(t,e){var i=this;i.$loading.open(),n["a"].post(t,e).then(function(t){i.$loading.close();var e=t;e.code>0?i.$message.error(e.msg):(i.onClose(),i.refresh(),i.$message.success(e.msg))}).catch(function(t){i.$loading.close(),console.log(t)})}}},r=l,s=(i("39b9"),i("2877")),c=Object(s["a"])(r,a,o,!1,null,null,null);e["default"]=c.exports},e81a:function(t,e,i){}}]);