(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5d259583","chunk-b9236dde","chunk-2d0e4caa","chunk-2d0b9996"],{1663:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{span:12}},[a("a-form-item",[a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.contractAdd()}}},[e._v("添加")])],1)],1)],1),a("a-table",{attrs:{columns:e.columns,dataSource:e.contractList,pagination:!1,rowKey:"ContractGuid"},scopedSlots:e._u([{key:"StatusText",fn:function(t,s){return a("span",{staticStyle:{"text-align":"right"}},[e._v("\n      "+e._s(s.StatusText)+"\n      "),40==s.Status&&s.Result?[10==s.Result?a("span",{staticStyle:{color:"#52c41a"}},[e._v("("+e._s(s.ResultText)+")")]):e._e(),20==s.Result?a("span",{staticStyle:{color:"#f5222d"}},[e._v("("+e._s(s.ResultText)+")")]):e._e()]:e._e()],2)}},{key:"action",fn:function(t,s){return a("span",{staticStyle:{"text-align":"right"}},[a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[e._v("\n          更多\n          "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",{on:{click:function(t){return e.detail(s)}}},[e._v("详情")]),(30==s.Status||40==s.Status&&20==s.Result)&&s.ProcessInstanceId&&e.userid==s.CreateUserid?a("a-menu-item",{on:{click:function(t){return e.contractAdd(s)}}},[e._v("重新发起")]):e._e()],1)],1)],1)}}])},[a("template",{slot:"footer"},[a("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:e.formSearch.pageSize,total:e.formSearch.total,current:e.formSearch.current},on:{change:e.contractListChange}})],1)],2),a("drawer-contract-add",{attrs:{show:e.drawer.contractadd,refresh:e.refreshAll}}),a("drawer-contract-detail",{attrs:{show:e.drawer.contractdetail,refresh:e.init}})],1)},i=[],r=(a("ac6a"),a("b775")),o=a("c32d"),l=a.n(o),n=a("a903"),c=a("33a7"),d=[{title:"状态",scopedSlots:{customRender:"StatusText"},width:90},{title:"产品线",dataIndex:"ProductLineText",width:140},{title:"客商类型",dataIndex:"ComTypeText",width:90},{title:"销售姓名",dataIndex:"CreateUseridText",width:90},{title:"类型",dataIndex:"SignTypeText",width:70},{title:"发送审核日期",dataIndex:"CreateDate",width:120},{title:"操作",scopedSlots:{customRender:"action"}}],u={name:"contractList",components:{DrawerContractAdd:n["default"],DrawerContractDetail:c["default"]},props:{show:{type:Object,default:function(){}},refresh:{type:Function,default:null},assetsdetail:{type:Object,default:""},componenttype:{type:String,default:""},userid:{type:String,default:""}},data:function(){return{visible:{show:!1,id:{},userid:"",comRankObject:{}},columns:d,dim:{ComProductLine:[]},formSearch:{pageSize:5,current:1,total:0,next:!0},contractList:[],enableeditguid:"",form:this.$form.createForm(this),drawer:{contractadd:{show:!1},contractdetail:{show:!1}},modal:{outchange:{show:!1}},User:{},Dept:{},comRankObject:{}}},created:function(){this.init()},methods:{init:function(){var e=this;e.$nextTick(function(){e.contractListChange(1)}),r["a"].post("/api/Dim/Enum/DimDecode",{Names:["User","Dept"]}).then(function(t){e.$loading.close(),0===t.code&&(e.User=t.data.User,e.Dept=t.data.Dept)}).catch(function(t){e.$loading.close(),console.log(t)}),r["a"].post("/api/Dim/Enum/GetEnum",{Names:["ComRankNormal"]}).then(function(t){0===t.code?t.data.ComRankNormal.forEach(function(t,a){e.comRankObject[t.key]=t.text}):e.$message.error(t.msg)}).catch(function(e){console.log(e)})},detail:function(e){this.drawer.contractdetail={show:!0,assetsdetail:e,Dept:this.Dept,User:this.User,comRankObject:this.comRankObject}},searchContract:function(){this.contractListChange(1)},contractAdd:function(e){var t=this,a={};e?t.$confirm({title:"请仔细检查所填项！",content:"点击确定重新发起合同！",onOk:function(){e.ProcessInstanceId&&(a=JSON.parse(e.FormComponentValues),a["开始日期"]=l()(a["开始日期"]),a["终止日期"]=l()(a["终止日期"]),console.log(a),t.drawer.contractadd={show:!0,assetsdetail:t.assetsdetail,componenttype:t.componenttype,reapplydetail:e,FormComponentValues:a})},onCancel:function(){}}):(e={},t.drawer.contractadd={show:!0,assetsdetail:t.assetsdetail,componenttype:t.componenttype,reapplydetail:e,FormComponentValues:a})},modify:function(){this.drawer.linemodify={show:!0,id:this.show.id,assetsdetail:this.assetsdetail.line}},contractListChange:function(e){var t=this,a=t.formSearch;t.formSearch.current=e,"line"===t.componenttype&&(a.ComProductLineGuid=t.assetsdetail.line.ComProductLineGuid),"company"===t.componenttype&&(a.ComGuid=t.assetsdetail.ComGuid),t.form.validateFields(function(e,s){e||r["a"].post("/api/Crm/Contract/List",a).then(function(e){0===e.code&&(t.formSearch.total=e.count,t.contractList=e.data.rows,e.data.rows.length<t.formSearch.pageSize&&(t.formSearch.next=!1))}).catch(function(e){console.log(e)})})},refreshAll:function(){this.init(),this.refresh&&this.refresh()}}},p=u,m=a("2877"),h=Object(m["a"])(p,s,i,!1,null,null,null);t["default"]=h.exports},"33a7":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{message:"",visible:this.visible.show,width:450,destroyOnClose:!0,closable:!1},on:{close:e.onClose}},[a("template",{slot:"title"},[e._v("\n    合同详情\n  ")]),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("公司名称:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.ComName?e.visible.assetsdetail.ComName:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("客商类型:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.ComTypeText?e.visible.assetsdetail.ComTypeText:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("客户评级:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.rankText?e.rankText:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("产品线:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.ProductLineText?e.visible.assetsdetail.ProductLineText:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("申请日期:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.CreateDate?e.visible.assetsdetail.CreateDate:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("开始日期:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.StartDate?e.visible.assetsdetail.StartDate:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("终止日期:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.EndDate?e.visible.assetsdetail.EndDate:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("是否延期:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["是否延期"]?e.FormComponentValues["是否延期"]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("服务内容:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["服务内容"]?e.FormComponentValues["服务内容"]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("服务部门:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["服务部门"]?e.visible.Dept[e.FormComponentValues["服务部门"]]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("申请类型:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.SignTypeText?e.visible.assetsdetail.SignTypeText:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("合同内容:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["合同内容"]?e.FormComponentValues["合同内容"]:"无"))])],1),e.FormComponentValues["标准合同修改内容"]&&e.FormComponentValues["标准合同修改内容"][0]["原合同内容"]?e._l(e.FormComponentValues["标准合同修改内容"],function(t,s){return a("a-row",{key:s,staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{attrs:{span:24}},[a("a-divider",{staticStyle:{"font-size":"12px"},attrs:{dashed:"",orientation:"left"}},[e._v("标准合同修改内容("+e._s(s+1)+"):")])],1),a("a-col",{attrs:{span:24}},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("原合同内容：")]),e._v(e._s(t["原合同内容"]))]),a("a-col",{attrs:{span:24}},[a("span",{staticStyle:{"font-weight":"bold"}},[e._v("修改后合同内容：")]),e._v(e._s(t["修改后合同内容"]))])],1)}):e._e(),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("垫付:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["垫付"]?e.FormComponentValues["垫付"]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("垫付金额:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["垫付金额"]?e.FormComponentValues["垫付金额"]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("垫付周期:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["垫付周期"]?e.FormComponentValues["垫付周期"]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("月服务费:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["月服务费"]?e.FormComponentValues["月服务费"]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("垫付说明:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["垫付说明"]?e.FormComponentValues["垫付说明"]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("信息提供者:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["信息提供者"]?e.visible.User[e.FormComponentValues["信息提供者"]]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("签单支持部门:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["签单支持部门"]?e.visible.Dept[e.FormComponentValues["签单支持部门"]]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("签单支持员工:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.FormComponentValues["签单支持员工"]?e.visible.User[e.FormComponentValues["签单支持员工"]]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("状态:")]),a("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetsdetail.StatusText?e.visible.assetsdetail.StatusText:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("审批结果:")]),a("a-col",{attrs:{span:18}},[10==e.visible.assetsdetail.Result?a("span",{staticStyle:{color:"#52c41a"}},[e._v(e._s(e.visible.assetsdetail.ResultText?e.visible.assetsdetail.ResultText:"无"))]):e._e(),20==e.visible.assetsdetail.Result?a("span",{staticStyle:{color:"#f5222d"}},[e._v(e._s(e.visible.assetsdetail.ResultText?e.visible.assetsdetail.ResultText:"无"))]):e._e()])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("附件:")]),a("a-col",{attrs:{span:18}},[1==e.notInDingTalk?a("div",[a("a-tag",{attrs:{color:"red"}},[e._v("请到钉钉应用界面查看附件！")])],1):e._e(),0==e.notInDingTalk?[e.uploadArry.length>0?e._l(e.uploadArry,function(t){return a("div",{key:t.fileId},[a("a-icon",{attrs:{type:"file-text"}}),e._v(" "+e._s(t.fileName)+"  "),a("a-icon",{staticStyle:{cursor:"pointer",color:"#1890ff"},attrs:{type:"file-search"},on:{click:function(a){return e.preview(t)}}})],1)}):[e._v("无")]]:e._e()],2)],1),a("a-row",{staticStyle:{padding:"10px 0"},attrs:{gutter:24}})],2)},i=[],r=(a("6b54"),a("b775")),o=(a("c32d"),{components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,id:{},assetsdetail:{},Dept:{},User:{},comRankObject:{}},FormComponentValues:{},formSearch:{pageSize:5,current:1,total:0,next:!0},form:this.$form.createForm(this),drawer:{},modal:{outchange:{show:!1}},SpaceId:"",uploadArry:[],fescoMessage:{},notInDingTalk:!1,rankText:""}},created:function(){var e=this;this.$watch("show",function(t,a){e.visible=t,e.visible.show&&e.init()})},methods:{init:function(){var e=this;try{e.FormComponentValues=JSON.parse(this.visible.assetsdetail.FormComponentValues)}catch(t){e.FormComponentValues={"服务内容":this.visible.assetsdetail.FormComponentValues}}r["a"].get("/api/DingTalk/CspaceInfo").then(function(t){var a=t,s=a.data.SpaceId;0===a.code&&(e.SpaceId=s)}).catch(function(e){console.log(e)}),r["a"].post("/api/DingTalk/GetSign",{}).then(function(t){e.fescoMessage=t.data,dd.config({agentId:t.data.AgentId,corpId:t.data.corpId,timeStamp:t.data.timeStamp,nonceStr:t.data.nonceStr,signature:t.data.signature,type:0,jsApiList:["biz.cspace.saveFile","biz.util.uploadAttachment","biz.cspace.preview","biz.cspace.chooseSpaceDir"]})}).catch(function(e){console.log(e)}),"notInDingTalk"==dd.env.platform&&(e.notInDingTalk=!0),e.FormComponentValues["附件"]&&(e.uploadArry=e.FormComponentValues["附件"]),r["a"].post("/api/Crm/ComRank/Last",{ComGuid:e.visible.assetsdetail.ComGuid}).then(function(t){0===t.code&&(t.data?e.rankText=e.visible.comRankObject[t.data.Rank]:e.rankText="")}).catch(function(e){console.log(e)})},onClose:function(){this.visible.show=!1,this.sourceListRecords=[],this.formSearch.next=!0,this.assetsdetail={company:{},line:{},leads:{}},this.refresh&&this.refresh()},preview:function(e){var t=this;dd.ready(function(){dd.biz.cspace.preview({corpId:t.fescoMessage.corpId,spaceId:t.SpaceId.toString(),fileId:e.fileId,fileName:e.fileName,fileSize:e.fileSize,fileType:e.fileType,onSuccess:function(){},onFail:function(e){}})})}}}),l=o,n=a("2877"),c=Object(n["a"])(l,s,i,!1,null,null,null);t["default"]=c.exports},3443:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{message:"",visible:this.visible.show,width:450,destroyOnClose:!0,closable:!1},on:{close:e.onClose}},[a("template",{slot:"title"},[e._v("\n    联系人详情\n  ")]),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("联系人姓名:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.Linkman?e.visible.assetsdetail.Linkman:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("手机号码:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.Mobile?e.visible.assetsdetail.Mobile:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("联系电话:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.Tel?e.visible.assetsdetail.Tel:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("产品线:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.ProductLineText?e.visible.assetsdetail.ProductLineText:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("邮箱:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.Email?e.visible.assetsdetail.Email:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("部门:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.Department?e.visible.assetsdetail.Department:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("职能:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.JobTitle?e.visible.assetsdetail.JobTitle:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("地址:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.Address?e.visible.assetsdetail.Address:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("创建时间:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.CreateDate?e.visible.assetsdetail.CreateDate:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("更新时间:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.UpdateTime?e.visible.assetsdetail.UpdateTime:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:24}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:7}},[e._v("备注:")]),a("a-col",{attrs:{span:17}},[e._v(e._s(e.visible.assetsdetail.Remarks?e.visible.assetsdetail.Remarks:"无"))])],1)],2)},i=[],r=(a("b775"),{components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,id:{},assetsdetail:{}},assetsdetail:{}}},created:function(){var e=this;this.$watch("show",function(t,a){e.visible=t,e.visible.show&&e.init()})},methods:{init:function(){},onClose:function(){this.visible.show=!1,this.assetsdetail={},this.refresh&&this.refresh()}}}),o=r,l=a("2877"),n=Object(l["a"])(o,s,i,!1,null,null,null);t["default"]=n.exports},"3ffd":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"选择协同人员",destroyOnClose:!0,visible:this.visible.show,maskClosable:!0},on:{ok:e.handleSubmit,cancel:e.onClose}},[a("a-form",{attrs:{form:e.form,layout:"horizontal"}},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{md:24}},[a("a-form-item",{attrs:{label:"部门",labelCol:{span:6},wrapperCol:{span:18}}},[a("a-cascader",{attrs:{options:e.allOptions,loadData:e.loadDataAll,changeOnSelect:"",placeholder:"请选择交接部门"},on:{change:e.onChangeAll},model:{value:e.handover.DepId,callback:function(t){e.$set(e.handover,"DepId",t)},expression:"handover.DepId"}})],1),a("a-form-item",{attrs:{label:"姓名",labelCol:{span:6},wrapperCol:{span:18}}},[a("a-select",{model:{value:e.handover.Userid,callback:function(t){e.$set(e.handover,"Userid",t)},expression:"handover.Userid"}},e._l(e.AllUserList,function(t){return a("a-select-option",{key:t.code},[e._v(e._s(t.name))])}),1)],1)],1)],1)],1)],1)},i=[],r=a("75fc"),o=(a("7f7f"),a("ac6a"),a("b775")),l={props:{show:{type:Object,default:function(){return{show:!1}}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,detail:{}},form:this.$form.createForm(this),AFormImportRules:{iptInputReq:[{required:!0,message:"请输入"}]},handover:{DepId:[],Userid:"",record:{}},allOptions:[],AllUserList:[]}},watch:{show:function(e,t){var a=this;a.visible=e,e.show&&a.init()}},methods:{onClose:function(){this.visible.show=!1,this.allOptions=[],this.AllUserList=[],this.refresh&&this.refresh(),this.form.resetFields()},init:function(){this.getAllDep()},handleSubmit:function(e){var t=this;t.handover.DepId===[]?t.$message.error("请选择部门！"):""===t.handover.Userid?t.$message.error("请选择人员！"):o["a"].post("/api/Crm/ProductLine/Xietong",{ComProductLineGuid:t.visible.detail.ComProductLineGuid,Userid:t.handover.Userid}).then(function(e){0===e.code?(t.handover={DepId:[],Userid:""},t.$message.success(e.msg),t.onClose()):t.$message.error(e.msg)}).catch(function(e){console.log(e)})},getAllDep:function(){var e=this;o["a"].post("/api/Org/Department/ChildrenDepsByDepId",{DepId:"1"}).then(function(t){0===t.code&&t.data.forEach(function(t,a){var s={};s.value=t.code,s.label=t.name,s.isLeaf=!1,e.allOptions.push(s)})}).catch(function(e){console.log(e)})},loadDataAll:function(e){var t=e[e.length-1],a=this;t.loading=!0,o["a"].post("/api/Org/Department/ChildrenDepsByDepId",{DepId:t.value}).then(function(e){t.loading=!1,0===e.code&&(e.data.length>0?(t.children=[],e.data.forEach(function(e,a){var s={};s.value=e.code,s.label=e.name,s.isLeaf=!1,t.children.push(s)}),a.allOptions=Object(r["a"])(a.allOptions)):(t.isLeaf=!0,t.loading=!1,a.allOptions=Object(r["a"])(a.allOptions)))}).catch(function(e){console.log(e),t.loading=!1})},onChangeAll:function(e){this.AllUserList=[],this.handover.Userid="",this.userbydepidAll(e[e.length-1])},userbydepidAll:function(e){var t=this;o["a"].post("/api/Org/User/UsersByDepId",{DepId:e}).then(function(e){var a=e;0===a.code&&(t.AllUserList=a.data)}).catch(function(e){console.log(e)})}}},n=l,c=a("2877"),d=Object(c["a"])(n,s,i,!1,null,null,null);t["default"]=d.exports},"51c1":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{title:e.visible.title,placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:450}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"产品线",labelCol:{span:6},wrapperCol:{span:16}}},["modify"==e.visible.type?[e._v("\n              "+e._s(e.visible.assetsdetail.ProductLineText)+"               \n            ")]:"detailadd"==e.visible.type?[e._v("\n              "+e._s(e.visible.assetsdetail.line.ProductLineText)+"               \n            ")]:[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ComProductLineGuid",{rules:e.AFormImportRules.iptSelectReq}],expression:"['ComProductLineGuid',{rules:AFormImportRules.iptSelectReq }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.ComProductLine,function(t){return a("a-select-option",{key:t.ComProductLineGuid},[e._v(e._s(t.ProductLineText))])}),1)]],2),a("a-form-item",{attrs:{label:"联系人姓名",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Linkman",{initialValue:e.visible.assetsdetail.Linkman,rules:e.AFormImportRules.iptInputReq}],expression:"['Linkman',{initialValue:visible.assetsdetail.Linkman,rules:AFormImportRules.iptInputReq}]"}]})],1),a("a-form-item",{attrs:{label:"手机号码",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Mobile",{initialValue:e.visible.assetsdetail.Mobile,rules:e.AFormImportRules.Mobile}],expression:"['Mobile',{initialValue:visible.assetsdetail.Mobile,rules:AFormImportRules.Mobile}]"}]})],1),a("a-form-item",{attrs:{label:"固定电话",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Tel",{initialValue:e.visible.assetsdetail.Tel,rules:e.AFormImportRules.iptInput}],expression:"['Tel',{initialValue:visible.assetsdetail.Tel,rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"邮箱",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Email",{initialValue:e.visible.assetsdetail.Email,rules:e.AFormImportRules.Email}],expression:"['Email',{initialValue:visible.assetsdetail.Email,rules:AFormImportRules.Email}]"}]})],1),a("a-form-item",{attrs:{label:"部门",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Department",{initialValue:e.visible.assetsdetail.Department,rules:e.AFormImportRules.iptInput}],expression:"['Department',{initialValue:visible.assetsdetail.Department,rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"职位职务",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["JobTitle",{initialValue:e.visible.assetsdetail.JobTitle,rules:e.AFormImportRules.iptInput}],expression:"['JobTitle',{initialValue:visible.assetsdetail.JobTitle,rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"快递地址",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Address",{initialValue:e.visible.assetsdetail.Address,rules:e.AFormImportRules.iptInput}],expression:"['Address',{initialValue:visible.assetsdetail.Address,rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"备注",labelCol:{span:6},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Remarks",{initialValue:e.visible.assetsdetail.Remarks}],expression:"['Remarks',{initialValue:visible.assetsdetail.Remarks}]"}],attrs:{placeholder:"备注",rows:4}})],1)],1),a("div",{style:{position:"absolute",bottom:"0",right:"0",width:"100%",padding:"10px 16px",borderTop:"1px solid #e8e8e8",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[a("a-button",{on:{click:e.onClose}},[e._v("取消")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},i=[],r=a("b775"),o=a("61f7"),l={components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,assetsdetail:{}},ComProductLine:[],form:this.$form.createForm(this),AFormImportRules:{iptInput:[{message:"请输入"}],iptInputReq:[{required:!0,message:"请输入"}],iptSelect:[{required:!1,message:"请选择"}],iptSelectReq:[{required:!0,message:"请选择"}],Mobile:[{required:!1,message:"请输入手机号"},{validator:this.ConfirmMobile}],Email:[{message:"请输入邮箱"},{validator:this.ConfirmEmail}]}}},watch:{show:function(e,t){var a=this;a.visible=e,e.show&&a.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.form.resetFields()},init:function(){var e=this,t="";"add"==e.visible.type&&(t=e.visible.assetsdetail.company.ComGuid,r["a"].post("/api/Crm/ProductLine/ListByCom",{ComGuid:t,Scene:"我的",pageSize:50,current:1,total:0}).then(function(t){0===t.code&&(e.ComProductLine=t.data.rows)}).catch(function(e){console.log(e)}))},handleSubmit:function(e){var t=this;this.form.validateFields(function(e,a){if(!e){var s=a,i="";"modify"==t.visible.type&&(s.ComContactGuid=t.visible.assetsdetail.ComContactGuid,s.ComGuid=t.visible.assetsdetail.ComGuid,s.ComProductLineGuid=t.visible.assetsdetail.ComProductLineGuid,i="/api/Crm/Contact/Modify"),"add"!=t.visible.type&&"detailadd"!=t.visible.type||(s.ComGuid=t.visible.assetsdetail.company.ComGuid,i="/api/Crm/Contact/Add"),"detailadd"==t.visible.type&&(s.ComProductLineGuid=t.visible.assetsdetail.line.ComProductLineGuid),t.$loading.open(),r["a"].post(i,s).then(function(e){t.$loading.close();var a=e;a.code>0?t.$message.error(a.msg):(t.refresh&&t.refresh(),t.onClose(),t.$message.success(a.msg))}).catch(function(e){t.$loading.close(),console.log(e)})}})},ConfirmEmail:function(e,t,a){!t||Object(o["b"])(t)?a():a("邮箱不符合规则！")}}},n=l,c=a("2877"),d=Object(c["a"])(n,s,i,!1,null,null,null);t["default"]=d.exports},"51d9":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{title:"新建沟通记录",placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:400}},[a("a-card",{attrs:{bordered:!1}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"产品线",labelCol:{span:8},wrapperCol:{span:16}}},["detailadd"==e.visible.type?[e._v("\n          "+e._s(e.visible.assetsdetail.line.ProductLineText)+"               \n        ")]:[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ComProductLineGuids",{rules:e.AFormImportRules.iptSelect}],expression:"['ComProductLineGuids',{rules:AFormImportRules.iptSelect}]"}],attrs:{mode:"multiple",placeholder:"请选择",allowClear:!0}},e._l(e.ComProductLine,function(t){return a("a-select-option",{key:t.ComProductLineGuid},[e._v(e._s(t.ProductLineText))])}),1)]],2),"detailadd"==e.visible.type?a("a-form-item",{attrs:{label:"预算",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Budget",{initialValue:e.visible.assetsdetail.line.Budget,rules:e.AFormImportRules.iptInput}],expression:"['Budget',{initialValue:visible.assetsdetail.line.Budget,rules:AFormImportRules.iptInput}]"}]})],1):e._e(),a("a-form-item",{attrs:{label:"联系人",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ComContactGuid",{initialValue:e.visible.connectdetail.ComContactGuid,rules:e.AFormImportRules.iptSelect}],expression:"['ComContactGuid',{initialValue:visible.connectdetail.ComContactGuid,rules:AFormImportRules.iptSelect }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.linkmanList,function(t){return a("a-select-option",{key:t.ComContactGuid},[e._v(e._s(t.Linkman))])}),1)],1),a("a-form-item",{attrs:{label:"联系方式",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ContactType",{rules:e.AFormImportRules.iptSelect}],expression:"['ContactType',{rules:AFormImportRules.iptSelect }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.dim.ContactType,function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1),a("a-form-item",{attrs:{label:"联系内容",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ContactContent",{rules:e.AFormImportRules.iptInput}],expression:"['ContactContent',{rules:AFormImportRules.iptInput}]"}],attrs:{placeholder:"请输入联系内容",rows:4}})],1),a("a-form-item",{attrs:{label:"下次联系时间",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["NextContacttime"],expression:"['NextContacttime']"}],attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss"}})],1),"detailadd"==e.visible.type&&null!=e.visible.assetsdetail.line.Stage&&parseInt(e.visible.assetsdetail.line.Stage)<30?[a("a-form-item",{attrs:{label:"是否迁升",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-radio-group",{directives:[{name:"decorator",rawName:"v-decorator",value:["value",{initialValue:"0"},{rules:[{required:!0,message:"请选择"}]}],expression:"['value', {initialValue: '0'}, {rules: [{ required: true, message: '请选择' }]}]"}],on:{change:e.onChange}},[a("a-radio",{attrs:{value:"1"}},[e._v("\n            是\n          ")]),a("a-radio",{attrs:{value:"0"}},[e._v("\n            否\n          ")])],1)],1),1==e.ProcessUp?[parseInt(e.visible.assetsdetail.line.Stage)+10==20?[a("a-form-item",{attrs:{label:"需求概况",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Reason1",{rules:e.AFormImportRules.Remarks}],expression:"['Reason1',{rules:AFormImportRules.Remarks}]"}],attrs:{placeholder:"需求概况",rows:4}})],1),a("a-form-item",{attrs:{label:"报价",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Reason2",{rules:e.AFormImportRules.Remarks}],expression:"['Reason2',{rules:AFormImportRules.Remarks}]"}],attrs:{placeholder:"报价",rows:4}})],1)]:e._e(),parseInt(e.visible.assetsdetail.line.Stage)+10==30?[a("a-form-item",{attrs:{label:"服务方案",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Reason1",{rules:e.AFormImportRules.Remarks}],expression:"['Reason1',{rules:AFormImportRules.Remarks}]"}],attrs:{placeholder:"服务方案",rows:4}})],1),a("a-form-item",{attrs:{label:"合同初稿",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Reason2",{rules:e.AFormImportRules.Remarks}],expression:"['Reason2',{rules:AFormImportRules.Remarks}]"}],attrs:{placeholder:"合同初稿",rows:18}})],1)]:e._e(),a("a-form-item",{attrs:{label:"附件",labelCol:{span:8},wrapperCol:{span:16}}},[a("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["uploadArry",{valuePropName:"fileList",getValueFromEvent:e.normFile,rules:e.AFormImportRules.upload}],expression:"[\n            'uploadArry',\n            {\n              valuePropName: 'fileList',\n              getValueFromEvent: normFile,\n              rules:AFormImportRules.upload\n            }\n          ]"}],attrs:{name:"files",action:"/api/Crm/ProductLine/UploadFile",data:e.uploadData}},[a("a-button",[a("a-icon",{attrs:{type:"upload"}}),e._v(" 上传附件 ")],1)],1)],1)]:e._e()]:e._e()],2)],1),a("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[a("a-button",{on:{click:e.onClose}},[e._v("取消")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},i=[],r=(a("ac6a"),a("b775")),o=(a("61f7"),{props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,assetsdetail:{line:{Budget:""}},connectdetail:{ComProductLineGuid:"",ComContactGuid:""}},dim:{Brand:[]},ComProductLine:[],DepList:[],linkmanList:[],form:this.$form.createForm(this),AFormImportRules:{iptDate:[{required:!0,message:"请选择"}],iptInput:[{required:!0,message:"请输入"}],iptSelect:[{required:!0,message:"请选择"}],Mobile:[{required:!0,message:"请输入手机号"},{validator:this.ConfirmMobile}],Remarks:[{required:!0,message:"请输入"}],upload:[{required:!1,message:"请上传"}]},ProcessUp:0,SpaceIdNormal:"",fescoMessage:{},uploadArry:[],notInDingTalk:!1,uploadData:{Domain:"SaleProcess"}}},watch:{show:function(e,t){var a=this;a.visible=e,e.show&&a.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.ProcessUp=0,this.form.resetFields()},init:function(){var e=this;"detailadd"==e.visible.type&&null!=e.visible.assetsdetail.line.Stage&&parseInt(e.visible.assetsdetail.line.Stage)+10==30?e.AFormImportRules.upload[0].required=!0:e.AFormImportRules.upload[0].required=!1,r["a"].post("/api/Crm/ProductLine/ListByCom",{ComGuid:e.visible.assetsdetail.company.ComGuid,Scene:"我的",pageSize:50,current:1,total:0}).then(function(t){0===t.code&&(e.ComProductLine=t.data.rows)}).catch(function(e){console.log(e)}),r["a"].post("/api/Dim/Enum/GetEnum",{Names:["ContactType"]}).then(function(t){0===t.code&&(e.dim.ContactType=t.data.ContactType)}).catch(function(e){console.log(e)}),r["a"].post("/api/Crm/Contact/List",{ComGuid:e.visible.assetsdetail.company.ComGuid,pageSize:50,current:1,total:0}).then(function(t){0===t.code&&(e.linkmanList=t.data.rows)}).catch(function(e){console.log(e)})},handleSubmit:function(e){var t=this;this.form.validateFields(function(a,s){if(!a){var i=s;i.ComGuid=t.visible.assetsdetail.company.ComGuid,i.FromType=t.visible.type,"detailadd"==t.visible.type&&(i.ComProductLineGuids=[],i.ComProductLineGuids.push(t.visible.assetsdetail.line.ComProductLineGuid),null!=t.visible.assetsdetail.line.Stage&&parseInt(t.visible.assetsdetail.line.Stage)<30?i.ProcessUp=1==t.ProcessUp:i.ProcessUp=!1,null!=t.visible.assetsdetail.line.Stage&&parseInt(t.visible.assetsdetail.line.Stage)<30&&1==t.ProcessUp&&(i.Reason1=s.Reason1,i.Reason2=s.Reason2,i.Files=[],t.uploadArry.forEach(function(e){i.Files.push(e.response.data.fileName)}))),t.$loading.open(),r["a"].post("/api/Crm/Contact/AddRecord",i).then(function(a){t.$loading.close();var s=a;s.code>0?t.$message.error(s.msg):("next"===e?(t.form.resetFields(),t.refresh&&t.refresh()):t.onClose(),s.data&&""!=s.data.msg&&t.$message.error(s.data.msg),t.$message.success("联系记录提交"+s.msg+"!"))}).catch(function(e){t.$loading.close(),console.log(e)})}})},onChange:function(e){this.ProcessUp=e.target.value},normFile:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:(this.uploadArry=e.fileList,console.log(this.uploadArry),e&&e.fileList)}}}),l=o,n=a("2877"),c=Object(n["a"])(l,s,i,!1,null,null,null);t["default"]=c.exports},"6e63":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{title:"修改产品线信息",placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:400}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"产品线",labelCol:{span:5},wrapperCol:{span:16}}},[e._v("\n            "+e._s(e.visible.assetsdetail.ProductLineText)+"\n          ")]),a("a-form-item",{attrs:{label:"部门",labelCol:{span:5},wrapperCol:{span:16}}},[e._v("\n            "+e._s(e.visible.assetsdetail.DepIdText)+"\n          ")]),a("a-form-item",{attrs:{label:"预算",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Budget",{initialValue:e.visible.assetsdetail.Budget,rules:e.AFormImportRules.iptInput}],expression:"['Budget',{initialValue:visible.assetsdetail.Budget,rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"备注",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Remarkspro",{initialValue:e.visible.assetsdetail.Remarks}],expression:"['Remarkspro',{initialValue:visible.assetsdetail.Remarks}]"}],attrs:{placeholder:"备注",rows:4}})],1)],1),a("div",{style:{position:"absolute",bottom:"0",right:"0",width:"100%",padding:"10px 16px",borderTop:"1px solid #e8e8e8",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[a("a-button",{on:{click:e.onClose}},[e._v("取消")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},i=[],r=a("b775"),o=a("61f7"),l={components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,assetsdetail:{company:{},line:{}}},dim:{Brand:[]},DepList:[],form:this.$form.createForm(this),AFormImportRules:{iptInput:[{required:!0,message:"请输入"},{validator:this.ConfirmNumber}],iptInputReq:[{required:!0,message:"请输入"}],iptSelect:[{required:!1,message:"请选择"}],iptSelectReq:[{required:!0,message:"请选择"}]}}},watch:{show:function(e,t){var a=this;a.visible=e,null==a.visible.assetsdetail&&(a.visible.assetsdetail={ComGuid:""}),e.show&&a.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.form.resetFields()},init:function(){var e=this;r["a"].get("/api/Org/Department/DepsByCurUser").then(function(t){0===t.code&&(e.DepList=t.data)}).catch(function(e){console.log(e)}),r["a"].post("/api/Dim/Enum/GetEnum",{Names:["ComProductLine"]}).then(function(t){0===t.code&&(e.dim.ComProductLine=t.data.ComProductLine)}).catch(function(e){console.log(e)})},ConfirmNumber:function(e,t,a){!t||Object(o["c"])(t)?a():a("请输入数字！")},handleSubmit:function(e){var t=this;this.form.validateFields(function(e,a){if(!e){var s={comProductLine:{ComGuid:t.visible.assetsdetail.ComGuid,ComProductLineGuid:t.visible.assetsdetail.ComProductLineGuid,ProductLine:t.visible.assetsdetail.ProductLine,DepId:t.visible.assetsdetail.DepId,Budget:a.Budget,Remarks:a.Remarkspro}};t.$loading.open(),r["a"].post("/api/Crm/ProductLine/Modify",s).then(function(e){t.$loading.close();var a=e;a.code>0?t.$message.error(a.msg):(t.onClose(),t.$message.success(a.msg))}).catch(function(e){t.$loading.close(),console.log(e)})}})}}},n=l,c=a("2877"),d=Object(c["a"])(n,s,i,!1,null,null,null);t["default"]=d.exports},"7e7e":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{title:"新建",placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:600}},[a("addcustomer",{attrs:{assetsdetail:{},fixed:!0},on:{onClose:e.onClose}})],1)},i=[],r=(a("b775"),a("61f7"),a("9272")),o={components:{addcustomer:r["default"]},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1},dim:{Brand:[]},DepList:[],form:this.$form.createForm(this),AFormImportRules:{iptDate:[{required:!0,message:"请选择"}],iptInput:[{required:!0,message:"请输入"}],iptSelect:[{required:!0,message:"请选择"}],Mobile:[{required:!0,message:"请输入手机号"},{validator:this.ConfirmMobile}]}}},watch:{show:function(e,t){var a=this;a.visible=e,e.show&&a.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.form.resetFields()},init:function(){}}},l=o,n=a("2877"),c=Object(n["a"])(l,s,i,!1,null,null,null);t["default"]=c.exports},9272:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{style:{overflow:"auto",height:"100%"}},[a("a-form",{attrs:{form:e.form}},[a("a-form-item",{attrs:{label:"公司名称",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["ComName",{initialValue:e.searchCom.Code,rules:e.AFormImportRules.iptInputReq}],expression:"['ComName',{initialValue:searchCom.Code,rules:AFormImportRules.iptInputReq}]"}]})],1),a("a-form-item",{attrs:{label:"组织机构代码证",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Code",{initialValue:e.searchCom.Code,rules:e.AFormImportRules.iptInput}],expression:"['Code',{initialValue:searchCom.Code,rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"网址",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Url",{initialValue:e.searchCom.Url,rules:e.AFormImportRules.iptInput}],expression:"['Url',{initialValue:searchCom.Url,rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"城市",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["cityname",{rules:e.AFormImportRules.iptInputReq}],expression:"['cityname',{rules:AFormImportRules.iptInputReq}]"}],attrs:{readOnly:"",placeholder:"请输入"},on:{click:e.chooseArea}})],1),a("a-form-item",{attrs:{label:"地址",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Address",{initialValue:e.searchCom.Address,rules:e.AFormImportRules.iptInputReq}],expression:"['Address',{initialValue:searchCom.Address,rules:AFormImportRules.iptInputReq}]"}]})],1),a("a-form-item",{attrs:{label:"客户来源",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["Source",{initialValue:e.searchCom.Source,rules:e.AFormImportRules.iptSelectReq}],expression:"['Source',{initialValue:searchCom.Source,rules:AFormImportRules.iptSelectReq }]"}],attrs:{allowClear:!0}},e._l(e.Source,function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1),a("a-form-item",{attrs:{label:"客户性质",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["Nature",{initialValue:e.searchCom.Nature,rules:e.AFormImportRules.iptSelectReq}],expression:"['Nature',{initialValue:searchCom.Nature,rules:AFormImportRules.iptSelectReq }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.Nature,function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1),a("a-form-item",{attrs:{label:"客户规模",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["Scale",{initialValue:e.searchCom.Scale,rules:e.AFormImportRules.iptSelectReq}],expression:"['Scale',{initialValue:searchCom.Scale,rules:AFormImportRules.iptSelectReq }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.Scale,function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1),a("a-form-item",{attrs:{label:"行业",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["Industry",{initialValue:e.searchCom.Industry,rules:e.AFormImportRules.iptSelectReq}],expression:"['Industry',{initialValue:searchCom.Industry,rules:AFormImportRules.iptSelectReq }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.Industry,function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1),a("a-form-item",{attrs:{label:"产品线",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ProductLine",{rules:e.AFormImportRules.iptSelectReq}],expression:"['ProductLine',{rules:AFormImportRules.iptSelectReq }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.dim.ComProductLine,function(t){return a("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1),a("a-form-item",{attrs:{label:"预算",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Budget",{rules:e.AFormImportRules.iptInputNumber}],expression:"['Budget',{rules:AFormImportRules.iptInputNumber}]"}]})],1),a("a-form-item",{attrs:{label:"部门",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["DepId",{rules:e.AFormImportRules.iptSelectReq}],expression:"['DepId',{rules:AFormImportRules.iptSelectReq }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.DepList,function(t){return a("a-select-option",{key:t.code},[e._v(e._s(t.name))])}),1)],1),a("a-form-item",{attrs:{label:"备注",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Remarkspro"],expression:"['Remarkspro']"}],attrs:{placeholder:"备注",rows:4}})],1),a("a-form-item",{attrs:{label:"联系人姓名",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Linkman",{rules:e.AFormImportRules.iptInputReq}],expression:"['Linkman',{rules:AFormImportRules.iptInputReq}]"}]})],1),a("a-form-item",{attrs:{label:"手机号码",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Mobile",{rules:e.AFormImportRules.Mobile}],expression:"['Mobile',{rules:AFormImportRules.Mobile}]"}]})],1),a("a-form-item",{attrs:{label:"固定电话",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Tel"],expression:"['Tel']"}]})],1),a("a-form-item",{attrs:{label:"邮箱",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Email",{rules:e.AFormImportRules.Email}],expression:"['Email',{rules:AFormImportRules.Email}]"}]})],1),a("a-form-item",{attrs:{label:"所在部门",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Department",{rules:e.AFormImportRules.iptInput}],expression:"['Department',{rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"职务",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["JobTitle",{rules:e.AFormImportRules.iptInput}],expression:"['JobTitle',{rules:AFormImportRules.iptInput}]"}]})],1),a("a-form-item",{attrs:{label:"通讯地址",labelCol:{span:5},wrapperCol:{span:16}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["personAddress",{rules:e.AFormImportRules.iptInput}],expression:"['personAddress',{rules:AFormImportRules.iptInput}]"}]})],1),1==e.fixed?a("div",{style:{height:"30px"}}):e._e()],1),a("div",{style:{position:"absolute",bottom:"0",right:"0",width:"100%",padding:"10px 16px",borderTop:"1px solid #e8e8e8",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[a("a-button",{on:{click:e.onClose}},[e._v("取消")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")])],1),a("chooseArea",{attrs:{openDrawer:e.drawer.area.show},on:{Closearea:e.areaClose,Surearea:e.areaSure}})],1)},i=[],r=(a("7f7f"),a("ac6a"),a("bd86")),o=a("b775"),l=(a("c32d"),a("61f7")),n=a("1269"),c={name:"addcustomer",components:{chooseArea:n["a"]},props:{assetsdetail:{type:Object,default:""},fixed:{type:Boolean,default:!1}},data:function(){return{visible:{show:!1,id:{}},dim:{},defaultData:{Source:"10"},dataSource:[],DepList:[],Source:[],Scale:[],Nature:[],Industry:[],searchCom:{},enableeditguid:"",form:this.$form.createForm(this),AFormImportRules:{iptDate:[{required:!0,message:"请选择"}],iptInput:[Object(r["a"])({message:"请输入"},"message","请输入")],iptInputReq:[{required:!0,message:"请输入"}],iptSelect:[{required:!1,message:"请选择"}],iptSelectReq:[{required:!0,message:"请选择"}],Mobile:[{message:"请输入手机号"},{validator:this.ConfirmMobile}],Email:[{message:"请输入邮箱"},{validator:this.ConfirmEmail}],iptInputNumber:[{required:!0,message:"请输入数字"},{validator:this.ConfirmNumber}]},drawer:{area:{show:!1}},modal:{},haveCom:!1,searchNext:!1,options:[],city:{}}},created:function(){this.init()},methods:{init:function(){var e=this;o["a"].get("/api/Org/Department/DepsByCurUser").then(function(t){0===t.code&&(e.DepList=t.data)}).catch(function(e){console.log(e)}),o["a"].post("/api/Dim/Enum/GetEnum",{Names:["Source","Scale","Nature","Industry","ComProductLine"]}).then(function(t){0===t.code&&(e.Source=t.data.Source,e.Industry=t.data.Industry,e.Scale=t.data.Scale,e.Nature=t.data.Nature,e.dim.ComProductLine=t.data.ComProductLine)}).catch(function(e){console.log(e)}),o["a"].post("/api/Dim/Enum/GetDim",{Names:["Province"]}).then(function(t){0===t.code&&t.data.Province.forEach(function(t,a){var s={};s.value=t.code,s.label=t.name,s.isLeaf=!1,e.options.push(s)})}).catch(function(e){console.log(e)})},handleSubmit:function(e){var t=this;this.form.validateFields(function(a,s){if(!a){var i={company:{ComName:s.ComName,Code:s.Code,Url:s.Url,Address:s.Address,Source:s.Source,Nature:s.Nature,Scale:s.Scale,Industry:s.Industry,CityCode:t.city.value},comProductLine:{ProductLine:s.ProductLine,DepId:s.DepId,Budget:s.Budget,Remarks:s.Remarkspro},comContact:{Linkman:s.Linkman,Mobile:s.Mobile,Tel:s.Tel,Email:s.Email,Department:s.Department,JobTitle:s.JobTitle,Address:s.personAddress},LeadsGuid:s.LeadsGuid};t.$loading.open(),o["a"].post("/api/Crm/Customer/Add",i).then(function(a){t.$loading.close();var s=a;s.code>0?t.$message.error(s.msg):("next"===e?(t.form.resetFields(),t.refresh&&t.refresh()):(t.$emit("onClose"),t.form.resetFields()),t.$message.success(s.msg))}).catch(function(e){t.$loading.close(),console.log(e)})}})},ConfirmMobile:function(e,t,a){!t||Object(l["d"])(t)?a():a("手机号码不符合规则！")},ConfirmEmail:function(e,t,a){!t||Object(l["b"])(t)?a():a("邮箱不符合规则！")},ConfirmNumber:function(e,t,a){!t||Object(l["c"])(t)?a():a("请输入数字！")},onClose:function(){this.$emit("onClose"),this.form.resetFields()},chooseArea:function(){this.drawer.area={show:!0}},areaClose:function(e){this.drawer.area={show:!1}},areaSure:function(e){this.city=e,this.drawer.area={show:!1},this.form.setFieldsValue({cityname:e.name})}}},d=c,u=a("2877"),p=Object(u["a"])(d,s,i,!1,null,null,null);t["default"]=p.exports},bbe5:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{attrs:{message:"",visible:this.visible.show,width:750,destroyOnClose:!0,closable:!1},on:{close:e.onClose}},[a("template",{slot:"title"},[e._v("\n    产品线详情\n    "),0!=e.assetsdetail.line.Opened||e.visible.userid!=e.visible.assetsdetail.Userid&&e.visible.userid!=e.visible.assetsdetail.XTUserid?e._e():a("a-button",{staticStyle:{float:"right"},attrs:{size:"small",icon:"form"},on:{click:e.modify}},[e._v("修改")]),0!=e.assetsdetail.line.Opened||e.visible.userid!=e.visible.assetsdetail.Userid&&e.visible.userid!=e.visible.assetsdetail.XTUserid?e._e():a("a-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"small",icon:"delete"},on:{click:e.throwLine}},[e._v("放弃")]),1==e.assetsdetail.line.Opened?a("a-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"small",icon:"pushpin"},on:{click:e.claimLine}},[e._v("认领")]):e._e(),0!=e.assetsdetail.line.Opened||e.visible.userid!=e.assetsdetail.line.Userid&&e.visible.userid!=e.assetsdetail.line.XTUserid||null!=e.assetsdetail.line.ServiceDepId||null!=e.assetsdetail.line.ServiceUserid?e._e():a("a-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"small",icon:"pushpin"},on:{click:e.serviceFormDetail}},[e._v("服务交接")]),0!=e.assetsdetail.line.Opened||e.visible.userid!=e.visible.assetsdetail.Userid&&e.visible.userid!=e.visible.assetsdetail.XTUserid?e._e():a("a-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"small",icon:"delete"},on:{click:e.claimEmployee}},[e._v("协同人员")])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("状态:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.Opened?"公海":e.assetsdetail.line.CooperatedText))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("产品线:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.ProductLineText?e.assetsdetail.line.ProductLineText:"无"))]),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("预算:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.Budget?e.assetsdetail.line.Budget:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("销售姓名:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.UseridText?e.assetsdetail.line.UseridText:"暂无销售"))]),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("协同人员:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.XTUserid?e.visible.UserArray[e.assetsdetail.line.XTUserid]:"暂无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("认领时间:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.PullTime?e.assetsdetail.line.PullTime:"无"))]),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:5}},[e._v("创建时间:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.CreateDate?e.assetsdetail.line.CreateDate:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("客服:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(void 0!=e.visible.assetsdetail.ServiceUserid?e.visible.UserArray[e.visible.assetsdetail.ServiceUserid]:"未交接"))]),a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("销售状态:")]),a("a-col",{attrs:{span:6}},[e._v(e._s(e.assetsdetail.line.Stage?e.visible.SaleStage[e.assetsdetail.line.Stage]:"无"))])],1),a("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:11}},[a("a-col",{staticStyle:{"text-align":"right"},attrs:{span:4}},[e._v("备注:")]),a("a-col",{attrs:{span:16}},[e._v(e._s(e.assetsdetail.line.Remarks?e.assetsdetail.line.Remarks:"无"))])],1),a("a-row",{staticStyle:{padding:"10px 0"},attrs:{gutter:24}}),a("div",[a("a-tabs",{attrs:{type:"card",defaultActiveKey:"1"},on:{change:e.callback}},[a("a-tab-pane",{key:"1",attrs:{tab:"沟通记录"}},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{span:24}},[a("a-form-item",[a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.connectAdd()}}},[e._v("添加")])],1)],1)],1),e.sourceListRecords.length>0?[a("a-timeline",[e._l(e.sourceListRecords,function(t){return a("a-timeline-item",{key:t.index},[a("p",[e._v(e._s(t.Contacttime)+" "),a("a-divider",{attrs:{type:"vertical"}}),e._v(" "+e._s(e.user[t.Userid])+"  "),a("a-divider",{attrs:{type:"vertical"}}),e._v(" "+e._s(e.ContactType[t.ContactType])+"沟通  "),a("a-divider",{attrs:{type:"vertical"}}),e._l(t.ProductLines,function(s,i){return[i==t.ProductLines.length-1?[a("span",{key:s},[e._v(e._s(e.ProductLine[s]))])]:[a("span",{key:s},[e._v(e._s(e.ProductLine[s]))]),e._v(",\n                ")]]})],2),a("p",[e._v("沟通内容："+e._s(t.ContactContent))]),1==t.ProcessUp?a("p",[e._v("附带销售阶段迁升")]):e._e()])}),a("a-timeline-item",[a("a",{directives:[{name:"show",rawName:"v-show",value:1==e.formSearch.next,expression:"formSearch.next==true"}],on:{click:e.loadMore}},[e._v("查看更多")]),a("span",{directives:[{name:"show",rawName:"v-show",value:0==e.formSearch.next,expression:"formSearch.next==false"}]},[a("a-icon",{attrs:{type:"smile"}}),e._v(" 我是有底线的")],1)])],2)]:e._e(),0==e.sourceListRecords.length?[a("div",[a("a-row",{staticStyle:{"text-align":"center"}},[a("a-icon",{attrs:{type:"smile"}}),e._v(" 暂无数据")],1)],1)]:e._e()],2),a("a-tab-pane",{key:"3",attrs:{tab:"合同"}},[a("contractList",{attrs:{assetsdetail:e.assetsdetail,componenttype:e.line,userid:e.visible.userid},on:{refresh:e.init}})],1),a("a-tab-pane",{key:"4",attrs:{tab:"联系人"}},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{span:24}},[a("a-form-item",[a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.linkAdd()}}},[e._v("添加")])],1)],1)],1),e.linkmanList.length>0?a("a-row",{attrs:{gutter:24}},e._l(e.linkmanList,function(t){return a("a-col",{key:t.ComContactGuid,attrs:{span:12}},[a("a-row",{staticClass:"linkman"},[a("a-col",{staticClass:"acol",attrs:{span:8}},[a("a-icon",{attrs:{type:"user"}}),e._v(" "+e._s(t.Linkman))],1),a("a-col",{staticClass:"acol",attrs:{span:16,align:"right"}},[a("a-icon",{attrs:{type:"phone"}}),e._v(e._s(t.Mobile)+" "),t.Tel&&t.Mobile?a("span",[e._v("/")]):e._e(),e._v(" "+e._s(t.Tel)+" "),t.Tel||t.Mobile?e._e():a("span",[e._v("没有联系方式")])],1),a("a-col",{staticClass:"acol",attrs:{span:10}},[e._v(e._s(t.ProductLineText))]),a("a-col",{staticClass:"acol",attrs:{span:14,align:"right"}},[e._v(e._s(t.Department)+" "),t.Department&&t.JobTitle?a("span",[e._v("/")]):e._e(),e._v(" "+e._s(t.JobTitle))]),a("a-col",{staticClass:"acol",attrs:{span:24}},[a("a",{on:{click:function(a){return e.linkDetail(t)}}},[e._v("详情")]),e._v(" | "),a("a",{on:{click:function(a){return e.linkModify(t)}}},[e._v("修改")]),e._v(" | "),a("a",{on:{click:function(a){return e.linkDelete(t)}}},[e._v("弃用")]),e._v(" | "),a("a",{on:{click:function(a){return e.connectAddLink(t)}}},[e._v("添加沟通记录")])])],1)],1)}),1):a("a-row",[a("a-col",{attrs:{align:"center"}},[a("a-icon",{attrs:{type:"smile"}}),e._v(" 暂无联系人")],1)],1),e.linkmanList.length>0?a("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:e.linkTable.pageSize,total:e.linkTable.total,current:e.linkTable.current},on:{change:e.linkmanListChange}}):e._e()],1)],1)],1),a("a-modal",{attrs:{title:"提示信息",visible:e.showClaimLayer,"confirm-loading":e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[a("a-form",{attrs:{layout:"horizontal"}},[a("div",[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{md:24}},[a("a-form-item",{attrs:{label:"所属部门",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[a("a-select",{model:{value:e.departmentKey,callback:function(t){e.departmentKey=t},expression:"departmentKey"}},e._l(e.department,function(t){return a("a-select-option",{key:t.code},[e._v("\n                      "+e._s(t.name)+"\n                    ")])}),1)],1)],1)],1)],1)])],1),a("drawer-edit",{attrs:{show:e.drawer.edit,refresh:e.init}}),a("drawer-connect-add",{attrs:{show:e.drawer.connectAdd,refresh:e.init}}),a("drawer-link-modify",{attrs:{show:e.drawer.linkmodify,refresh:e.initLink}}),a("drawer-link-detail",{attrs:{show:e.drawer.linkdetail,refresh:e.initLink}}),a("drawer-line-modify",{attrs:{show:e.drawer.linemodify,assetsdetail:{},refresh:e.init}}),a("modal-choose-employee",{attrs:{show:e.modal.employee,refresh:e.init}})],2)},i=[],r=(a("ac6a"),a("b775")),o=a("7e7e"),l=(a("c32d"),a("51d9")),n=a("51c1"),c=a("3443"),d=a("6e63"),u=a("1663"),p=a("3ffd"),m=[{title:"产品线",dataIndex:"ProductLineText",width:100},{title:"销售姓名",dataIndex:"UseridText",width:90},{title:"沟通方式",dataIndex:"ContactTypeText",width:90},{title:"沟通时间",dataIndex:"Contacttime",width:210},{title:"操作",scopedSlots:{customRender:"action"}}],h={components:{DrawerEdit:o["default"],DrawerConnectAdd:l["default"],DrawerLinkModify:n["default"],DrawerLinkDetail:c["default"],DrawerLineModify:d["default"],contractList:u["default"],ModalChooseEmployee:p["default"]},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null},deleteLine:{type:Function,default:null},serviceForm:{type:Function,default:null}},data:function(){return{visible:{show:!1,id:{},assetsdetail:{ServiceDepId:"",ServiceUserid:""},listText:{},userid:"",UserArray:[],DeptArray:[],SaleStage:{}},line:"line",showClaimLayer:!1,columnsconnect:m,formSearch:{pageSize:5,current:1,total:0,next:!0},linkTable:{pageSize:5,current:1,total:0},sourceListRecords:[],linkmanList:[],assetsdetail:{company:{},line:{},leads:{}},enableeditguid:"",form:this.$form.createForm(this),drawer:{edit:{show:!1},connectAdd:{show:!1},linkmodify:{show:!1},linkdetail:{show:!1},linemodify:{show:!1}},modal:{outchange:{show:!1},employee:{show:!1}},confirmLoading:!1,department:[],departmentKey:"",checkLineId:"",ContactType:{},ProductLine:{},user:{}}},created:function(){var e=this;this.$watch("show",function(t,a){e.visible=t,e.visible.show&&(console.log(e.visible),e.init())})},methods:{init:function(){var e=this;r["a"].post("/api/Crm/ProductLine/Detail",{ComProductLineGuid:e.visible.assetsdetail.ComProductLineGuid}).then(function(t){0===t.code&&(e.assetsdetail=t.data,e.sourceListRecords=[],e.formSearch.next=!0,e.visible.userid=t.data.Operator.Userid,e.pagechange(1))}).catch(function(e){console.log(e)}),r["a"].post("/api/Dim/Enum/GetEnum",{Names:["ComProductLine","ContactType"]}).then(function(t){0===t.code?(t.data.ComProductLine.forEach(function(t,a){e.ProductLine[t.key]=t.text}),t.data.ContactType.forEach(function(t,a){e.ContactType[t.key]=t.text})):e.$message.error(t.msg)}).catch(function(e){console.log(e)}),r["a"].post("/api/Dim/Enum/DimDecode",{Names:["User"]}).then(function(t){0===t.code?e.user=t.data.User:e.$message.error(t.msg)}).catch(function(e){console.log(e)})},onClose:function(){this.visible.show=!1,this.sourceListRecords=[],this.formSearch.next=!0,this.assetsdetail={company:{},line:{},leads:{}},this.refresh&&this.refresh()},detail:function(e){this.drawer.detail={show:!0,id:e.SBOrderItemGuid}},edit:function(){this.drawer.edit={show:!0,id:this.show.id,assetsdetail:this.assetsdetail}},modify:function(){this.drawer.linemodify={show:!0,id:this.show.id,assetsdetail:this.assetsdetail.line}},throwLine:function(){var e=this;e.deleteLine(this.visible.assetsdetail)},outchange:function(e){this.modal.outchange={show:!0,id:e.BalanceGuid,balance:e}},callback:function(e){4==e&&this.linkmanListChange(1)},loadMore:function(){this.formSearch.current=this.formSearch.current+1,this.pagechange(this.formSearch.current)},pagechange:function(e){var t=this,a=t.formSearch;t.formSearch.current=e,a.ComGuid=t.assetsdetail.company.ComGuid,a.ComProductLineGuid=t.assetsdetail.line.ComProductLineGuid,r["a"].post("/api/Crm/Contact/ListRecords",a).then(function(e){0===e.code&&(t.sourceListRecords=t.sourceListRecords.concat(e.data.rows),t.formSearch.total=e.count,e.data.rows.length<t.formSearch.pageSize&&(t.formSearch.next=!1))}).catch(function(e){console.log(e)})},initLink:function(){this.linkmanListChange(1)},linkmanListChange:function(e){var t=this,a=t.linkTable;t.linkTable.current=e,a.ComGuid=t.assetsdetail.company.ComGuid,a.ComProductLineGuid=t.assetsdetail.line.ComProductLineGuid,r["a"].post("/api/Crm/Contact/List",a).then(function(e){0===e.code&&(t.linkmanList=e.data.rows,t.linkTable.total=e.count)}).catch(function(e){console.log(e)})},connectAdd:function(){this.drawer.connectAdd={show:!0,assetsdetail:this.assetsdetail,type:"detailadd",connectdetail:{}}},connectAddLink:function(e){this.drawer.connectAdd={show:!0,assetsdetail:this.assetsdetail,type:"detailadd",connectdetail:e}},linkAdd:function(){this.drawer.linkmodify={show:!0,assetsdetail:this.assetsdetail,type:"detailadd",title:"新增联系人"}},linkModify:function(e){this.drawer.linkmodify={show:!0,assetsdetail:e,type:"modify",title:"修改联系人"}},linkDetail:function(e){this.drawer.linkdetail={show:!0,assetsdetail:e}},linkDelete:function(e){var t=this;t.$confirm({title:"确定弃用该联系人?",content:"点击确定弃用联系人。",onOk:function(){r["a"].post("/api/Crm/Contact/Throw",{ComContactGuid:e.ComContactGuid}).then(function(e){0===e.code?(t.$message.success(e.msg),t.initLink()):t.$message.error(e.msg)}).catch(function(e){console.log(e)})},onCancel:function(){}})},claimLine:function(){var e=this;e.showClaimLayer=!0,r["a"].get("/api/Org/Department/DepsByCurUser").then(function(t){0===t.code&&(e.department=t.data)}).catch(function(e){console.log(e)}),e.checkLineId=e.assetsdetail.line.ComProductLineGuid},handleOk:function(e){var t=this;t.departmentKey?r["a"].post("/api/Crm/ProductLine/Pick",{ComProductLineGuid:t.checkLineId,DepId:t.departmentKey}).then(function(e){0===e.code&&(t.showClaimLayer=!1,t.$message.success(e.msg),t.departmentKey="",t.checkLineId="",t.init(),t.refresh()),e.code>0&&t.$message.error(e.msg)}).catch(function(e){console.log(e)}):t.$message.error("请选择你的所属部门！")},handleCancel:function(e){this.showClaimLayer=!1,this.checkLineId=""},serviceFormDetail:function(){this.serviceForm(this.visible.assetsdetail,this.init)},claimEmployee:function(){this.modal.employee={show:!0,detail:this.visible.assetsdetail}}}},v=h,f=a("2877"),g=Object(f["a"])(v,s,i,!1,null,null,null);t["default"]=g.exports}}]);