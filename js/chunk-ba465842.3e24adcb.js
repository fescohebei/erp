(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ba465842","chunk-f8197eda"],{"124d":function(t,e,a){"use strict";var i=a("54ee"),s=a.n(i);s.a},3549:function(t,e,a){"use strict";var i=a("98d4"),s=a.n(i);s.a},"54ee":function(t,e,a){},"79a3":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-layout",[a("a-layout-content",[a("a-card",{attrs:{bordered:!1}},[a("div",[a("a-form",{attrs:{layout:"horizontal"}},[a("div",{class:t.advanced?null:"fold"},[a("a-row",{attrs:{gutter:10}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"财年",labelCol:{span:2},wrapperCol:{span:18}}},[a("a-select",{staticStyle:{width:"80px"},model:{value:t.formSearch.FiscalYear,callback:function(e){t.$set(t.formSearch,"FiscalYear",e)},expression:"formSearch.FiscalYear"}},[a("a-select-option",{attrs:{value:"2019"}},[t._v("2019")])],1),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.init}},[t._v("查询")]),a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.edit({BudgetGuid:null})}}},[t._v("添加")])],1)],1)],1)],1)])],1),a("a-table",{attrs:{columns:t.columns,dataSource:t.dataSource,pagination:!1,rowKey:"BudgetGuid"},scopedSlots:t._u([{key:"action",fn:function(e,i){return a("span",{staticStyle:{"text-align":"right"}},[a("a",{staticStyle:{"margin-left":"8px"},attrs:{disabled:i.Status>0},on:{click:function(e){return t.publish(i)}}},[t._v("发布")]),a("a",{staticStyle:{"margin-left":"8px"},attrs:{disabled:i.Status>0},on:{click:function(e){return t.edit(i)}}},[t._v("修改")])])}},{key:"subjects",fn:function(e,i){return t._l(i.Subjects,function(e){return a("a-tag",{key:e.key,attrs:{color:"blue"}},[t._v(t._s(e.Name))])})}}])},[a("template",{slot:"footer"},[a("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:t.formSearch.pageSize,total:t.formSearch.total,current:t.formSearch.current}})],1)],2)],1)],1),a("drawer-edit",{attrs:{show:t.drawer.edit,refresh:t.init,destroyOnClose:!0}})],1)},s=[],r=a("b775"),l=a("8804"),n=[{title:"财年",dataIndex:"FiscalYear"},{title:"科目",scopedSlots:{customRender:"subjects"}},{title:"状态",dataIndex:"StatusText"},{title:"操作",scopedSlots:{customRender:"action"}}],o={components:{DrawerEdit:l["default"]},data:function(){return{advanced:!0,columns:n,formSearch:{pageSize:10,current:1,total:0},dataSource:[],drawer:{detail:{show:!1,id:1},edit:{show:!1}}}},mounted:function(){var t=this;t.init()},methods:{init:function(){this.pagechange(1)},pagechange:function(t){var e=this;e.formSearch.current=t,r["a"].post("/api/Budget/Set/List",e.formSearch).then(function(t){var a=t;0===a.code&&(e.dataSource=a.data,e.formSearch.total=a.count)}).catch(function(t){console.log(t)})},edit:function(t){this.drawer.edit={show:!0,id:t.BudgetGuid,detail:t}},publish:function(t){var e=this;r["a"].post("/api/Budget/Set/PublishConfig",t).then(function(t){0===t.code&&(e.pagechange(e.formSearch.current),e.$message.success(t.msg))}).catch(function(t){console.log(t)})}}},c=o,u=(a("3549"),a("2877")),d=Object(u["a"])(c,i,s,!1,null,null,null);e["default"]=d.exports},8804:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a-drawer",{attrs:{title:"修改",placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:400}},[a("a-form",{attrs:{form:t.form}},[a("a-form-item",{attrs:{label:"财年",labelCol:{span:4},wrapperCol:{span:20}}},[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["FiscalYear",{initialValue:t.visible.detail.FiscalYear,rules:t.AFormImportRules.iptSelect}],expression:"['FiscalYear',{initialValue: visible.detail.FiscalYear,rules:AFormImportRules.iptSelect }]"}],staticStyle:{width:"60%","margin-right":"8px"},attrs:{placeholder:"请选择",allowClear:!0,disabled:null!=t.visible.id}},[a("a-select-option",{key:"2019"},[t._v("2019")]),a("a-select-option",{key:"2020"},[t._v("2020")]),a("a-select-option",{key:"2021"},[t._v("2021")])],1)],1),t._l(t.subjects,function(e){return a("a-form-item",{key:e.key,attrs:{label:"科目",labelCol:{span:4},wrapperCol:{span:20}}},[a("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["names["+e.key+"]",{initialValue:e.Name,rules:t.AFormImportRules.iptInput}],expression:"[\n        `names[${item.key}]`,\n        {\n          initialValue: item.Name,\n          rules: AFormImportRules.iptInput,\n        }\n      ]"}],staticStyle:{width:"60%","margin-right":"8px"},attrs:{placeholder:"科目"}}),t.subjects.length>1?a("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o",disabled:1===t.subjects.length},on:{click:function(){return t.remove(e)}}}):t._e()],1)}),a("a-form-item",{attrs:{label:"",labelCol:{span:4},wrapperCol:{span:20,offset:4}}},[a("a-button",{staticStyle:{width:"60%"},attrs:{type:"dashed"},on:{click:t.add}},[a("a-icon",{attrs:{type:"plus"}}),t._v("增加科目\n      ")],1)],1),a("a-form-item",{attrs:{label:"备注",labelCol:{span:4},wrapperCol:{span:20}}},[a("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Remarks",{initialValue:t.visible.detail.Remarks}],expression:"['Remarks',{initialValue:visible.detail.Remarks }]"}],attrs:{placeholder:"备注",rows:4}})],1)],2),a("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[a("a-button",{on:{click:t.onClose}},[t._v("取消")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:t.handleSubmit}},[t._v("提交")]),null==t.visible.id?a("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.handleSubmit("next")}}},[t._v("提交并继续录入")]):t._e()],1)],1)},s=[],r=(a("ac6a"),a("b775")),l={props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,detail:{FiscalYear:""}},subjects:[],form:this.$form.createForm(this),AFormImportRules:{iptInput:[{required:!0,message:"请输入"}],iptSelect:[{required:!0,message:"请选择"}]}}},watch:{show:function(t,e){var a=this;a.visible=t,t.show&&(null==a.visible.detail&&(a.visible.detail={FiscalYear:""}),a.visible.detail.Subjects||(a.visible.detail.Subjects=[]),a.init())}},methods:{onClose:function(){this.visible.show=!1,this.subjects=[],this.refresh&&this.refresh(),this.form.resetFields()},init:function(){for(var t=this,e=0;e<t.visible.detail.Subjects.length;e++)t.subjects.push({key:e,Name:t.visible.detail.Subjects[e].Name})},add:function(){var t=0;this.subjects.forEach(function(e){t=e.key>t?e.key:t}),this.subjects.push({key:t+1})},remove:function(t){this.subjects=this.subjects.filter(function(e){return e.key!=t.key});this.form.getFieldValue("keys")},handleSubmit:function(t){var e=this;this.form.validateFields(function(t,a){if(!t){var i=a;i.BudgetGuid=e.visible.id,r["a"].post("/api/Budget/Set/SaveConfig",i).then(function(t){var a=t;a.code>0?e.$message.error(a.msg):(e.onClose(),e.$message.success(a.msg))}).catch(function(t){console.log(t)})}})}}},n=l,o=(a("124d"),a("2877")),c=Object(o["a"])(n,i,s,!1,null,"3478f9a4",null);e["default"]=c.exports},"98d4":function(t,e,a){}}]);