(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-65060ca2","chunk-2d229da3","chunk-2d22c19d"],{2458:function(e,t,s){"use strict";var a=s("5efe"),r=s.n(a);r.a},"5efe":function(e,t,s){},"6f50":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-layout",[s("a-layout-content",[s("a-card",{attrs:{bordered:!1}},[s("div",[s("a-form",{attrs:{layout:"horizontal"}},[s("div",{class:e.advanced?null:"fold"},[s("a-row",{attrs:{gutter:10}},[s("a-col",{attrs:{md:5}},[s("a-form-item",{attrs:{label:"名称",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[s("a-input",{attrs:{placeholder:"请输入"},model:{value:e.formSearch.AssetsName,callback:function(t){e.$set(e.formSearch,"AssetsName",t)},expression:"formSearch.AssetsName"}})],1)],1),s("a-col",{attrs:{md:5}},[s("a-form-item",{attrs:{label:"编号",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[s("a-input",{attrs:{placeholder:"请输入"},model:{value:e.formSearch.AssetsCode,callback:function(t){e.$set(e.formSearch,"AssetsCode",t)},expression:"formSearch.AssetsCode"}})],1)],1),s("a-col",{attrs:{md:4}},[s("a-form-item",{attrs:{label:"状态",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[s("a-select",{model:{value:e.formSearch.AssetsStatus,callback:function(t){e.$set(e.formSearch,"AssetsStatus",t)},expression:"formSearch.AssetsStatus"}},[e._l(e.AssetsStatusList,function(t){return s("a-select-option",{key:t.key},[e._v("\n                      "+e._s(t.text)+"\n                    ")])}),s("a-select-option",{key:""},[e._v("\n                      全部\n                    ")])],2)],1)],1),s("a-col",{attrs:{span:8}},[s("a-form-item",[s("a-button",{attrs:{type:"primary"},on:{click:e.init}},[e._v("查询")]),s("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.edit({key:null})}}},[e._v("添加")]),s("a-button",{staticStyle:{"margin-left":"8px"},on:{click:e.exportbalanceout}},[e._v("领用记录导出")])],1)],1)],1)],1)])],1),s("a-table",{attrs:{columns:e.columns,dataSource:e.dataSource,pagination:!1,rowKey:"AssetsGuid"},scopedSlots:e._u([{key:"status",fn:function(t){return[1==t.AssetsStatus?s("span",{staticStyle:{color:"green"}},[e._v(e._s(t.AssetsStatusName))]):e._e(),2==t.AssetsStatus?s("span",{staticStyle:{color:"orange"}},[e._v(e._s(t.AssetsStatusName))]):e._e(),3==t.AssetsStatus?s("span",{staticStyle:{color:"red"}},[e._v(e._s(t.AssetsStatusName))]):e._e(),4==t.AssetsStatus?s("span",{staticStyle:{color:"blue"}},[e._v(e._s(t.AssetsStatusName))]):e._e(),5==t.AssetsStatus?s("span",{staticStyle:{color:"#aaa"}},[e._v(e._s(t.AssetsStatusName))]):e._e()]}},{key:"fixed",fn:function(t){return[e._v("\n          "+e._s(t.Price>=5e3?"是":"否(按固定资产管理)")+"\n        ")]}},{key:"action",fn:function(t,a){return s("span",{staticStyle:{"text-align":"right"}},[s("a",{on:{click:function(t){return e.detail(a)}}},[e._v("详情")]),s("a-divider",{attrs:{type:"vertical"}}),s("a-dropdown",[s("a",{staticClass:"ant-dropdown-link"},[e._v("\n              更多\n              "),s("a-icon",{attrs:{type:"down"}})],1),s("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a.AssetsStatus<3?s("a-menu-item",{on:{click:function(t){return e.transfer(a)}}},[e._v("交接")]):e._e(),a.AssetsStatus<3?s("a-menu-item",{on:{click:function(t){return e.edit(a)}}},[e._v("修改")]):e._e(),a.AssetsStatus<3?s("a-menu-item",{on:{click:function(t){return e.service(a)}}},[e._v("维修")]):e._e(),a.AssetsStatus<2?s("a-menu-item",{on:{click:function(t){return e.scrap(a)}}},[e._v("报废")]):e._e(),4==a.AssetsStatus?s("a-menu-item",{on:{click:function(t){return e.handle(a)}}},[e._v("处置")]):e._e()],1)],1)],1)}}])},[s("template",{slot:"footer"},[s("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:e.formSearch.pageSize,total:e.formSearch.total,current:e.formSearch.current},on:{change:e.pagechange}})],1)],2),s("a-modal",{attrs:{title:"报废",visible:e.showScrapLayer,"confirm-loading":e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[s("a-form",{attrs:{layout:"horizontal"}},[s("div",[s("a-row",{attrs:{gutter:10}},[s("a-col",{attrs:{md:24}},[s("a-form-item",{attrs:{label:"部门",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[s("a-select",{model:{value:e.departmentKey,callback:function(t){e.departmentKey=t},expression:"departmentKey"}},e._l(e.department,function(t){return s("a-select-option",{key:t.code},[e._v("\n                        "+e._s(t.name)+"\n                      ")])}),1)],1),s("a-form-item",{attrs:{label:"报废说明",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[s("a-textarea",{attrs:{placeholder:"备注",rows:4},model:{value:e.Remarks,callback:function(t){e.Remarks=t},expression:"Remarks"}})],1)],1)],1)],1)])],1)],1)],1),s("drawer-edit",{attrs:{show:e.drawer.edit,refresh:e.init}}),s("drawer-detail",{attrs:{show:e.drawer.detail,refresh:e.init,handle:e.handle,scrap:e.scrap}}),s("modal-export-transfer",{attrs:{show:e.modal.exporttransfer}}),s("drawer-transfer",{attrs:{show:e.drawer.transfer,refresh:e.init}}),s("drawer-service",{attrs:{show:e.drawer.service,refresh:e.init}}),s("drawer-handle",{attrs:{show:e.drawer.handle,refresh:e.init}})],1)},r=[],o=(s("ac6a"),s("b775")),n=s("e867"),i=s("d1e1"),l=s("dee1"),c=s("7145"),d=s("bbc3"),u=s("f294"),p=[{title:"状态",scopedSlots:{customRender:"status"}},{title:"编号",dataIndex:"AssetsCode"},{title:"名称",dataIndex:"AssetsName"},{title:"固定资产",scopedSlots:{customRender:"fixed"}},{title:"大类",dataIndex:"ClassName"},{title:"小类",dataIndex:"SubclassName"},{title:"购置日期",dataIndex:"PurchaseDate"},{title:"价格",dataIndex:"Price"},{title:"管理部门",dataIndex:"ManageDep"},{title:"使用部门",dataIndex:"UseDep"},{title:"使用人",dataIndex:"UseName"},{title:"操作",scopedSlots:{customRender:"action"}}],m={components:{DrawerEdit:n["default"],DrawerDetail:i["default"],ModalExportTransfer:l["default"],DrawerTransfer:c["default"],DrawerService:d["default"],DrawerHandle:u["default"]},data:function(){return{advanced:!0,columns:p,formSearch:{pageSize:10,current:1,total:0,AssetsStatus:""},dataSource:[],drawer:{transfer:{show:!1},detail:{show:!1,id:1},edit:{show:!1},service:{show:!1},handle:{show:!1}},modal:{exporttransfer:{show:!1}},Remarks:"",showScrapLayer:!1,confirmLoading:!1,scrapRecord:{},department:[],departmentKey:"",AssetsStatus:[],AssetsStatusList:[],DisposeType:{}}},mounted:function(){var e=this;e.init()},methods:{init:function(){var e=this;o["a"].post("/api/Dim/Enum/GetEnum",{Names:["AssetsStatus","DisposeType"]}).then(function(t){0===t.code?(e.AssetsStatusList=t.data.AssetsStatus,t.data.AssetsStatus.forEach(function(t,s){e.AssetsStatus[t.key]=t.text}),t.data.DisposeType.forEach(function(t,s){e.DisposeType[t.key]=t.text})):e.$message.error(t.msg)}).catch(function(e){console.log(e)}),this.pagechange(1)},pagechange:function(e){var t=this;t.formSearch.current=e,o["a"].post("/api/Supplies/Assets/List",t.formSearch).then(function(e){0===e.code&&(e.data.rows.forEach(function(e){e.PurchaseDate=moment(e.PurchaseDate).format("YYYY-MM-DD")}),t.dataSource=e.data.rows,t.formSearch.total=e.data.count)}).catch(function(e){console.log(e)})},detail:function(e){this.drawer.detail={show:!0,id:e.AssetsGuid,assetsdetail:e,DisposeType:this.DisposeType,AssetsStatusList:this.AssetsStatus}},edit:function(e){this.drawer.edit={show:!0,id:e.AssetsGuid,assetsdetail:e}},transfer:function(e){this.drawer.transfer={show:!0,id:e.AssetsGuid,assetstransferdetail:{AssetsCode:e.AssetsCode,AssetsName:e.AssetsName,BrandName:e.BrandName,Spec:e.Spec}}},exportbalanceout:function(){this.modal.exporttransfer={show:!0}},service:function(e){this.drawer.service={show:!0,id:e.AssetsGuid,assetscode:e.AssetsCode,assetsname:e.AssetsName,assetsservicedetail:{AssetsCode:e.AssetsCode,AssetsName:e.AssetsName}}},scrap:function(e){var t=this;t.showScrapLayer=!0,t.scrapRecord=e,o["a"].get("/api/Org/Department/DepsByCurUser").then(function(e){0===e.code&&(t.department=e.data)}).catch(function(e){console.log(e)})},handleOk:function(e){var t=this;t.Remarks&&t.departmentKey?o["a"].post("/api/Supplies/Assets/Scrap",{AssetsGuid:t.scrapRecord.AssetsGuid,"说明":t.Remarks,DepId:t.departmentKey}).then(function(e){0===e.code&&(t.showScrapLayer=!1,t.$message.success(e.msg),t.Remarks="",t.departmentKey="",t.init(),t.drawer.detail.show=!1),e.code>0&&t.$message.error(e.msg)}).catch(function(e){console.log(e)}):t.$message.error("请输入部门和报废说明！")},handleCancel:function(e){this.showScrapLayer=!1,this.Remarks=""},handle:function(e,t){this.drawer.handle=t?{show:!0,id:e.AssetsGuid,assetstransferdetail:{AssetsCode:e.AssetsCode,AssetsName:e.AssetsName,BrandName:e.BrandName,Spec:e.Spec},callback:t}:{show:!0,id:e.AssetsGuid,assetstransferdetail:{AssetsCode:e.AssetsCode,AssetsName:e.AssetsName,BrandName:e.BrandName,Spec:e.Spec}}}}},f=m,h=(s("2458"),s("2877")),v=Object(h["a"])(f,a,r,!1,null,null,null);t["default"]=v.exports},dee1:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-modal",{attrs:{title:"交付转移记录导出",destroyOnClose:!0,visible:this.visible.show,maskClosable:!0},on:{ok:e.handleSubmit,cancel:e.onClose}},[s("a-form",{attrs:{form:e.form},on:{submit:e.handleSubmit}},[s("a-form-item",{attrs:{label:"日期范围",labelCol:{span:6},wrapperCol:{span:16}}},[s("a-range-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["DatePicker",{rules:e.AFormImportRules.iptSelect}],expression:"['DatePicker',{rules:AFormImportRules.iptSelect }]"}]})],1)],1)],1)},r=[],o={props:{show:{type:Object,default:{show:!1}}},data:function(){return{visible:{show:!1},form:this.$form.createForm(this),AFormImportRules:{iptSelect:[{required:!0,message:"请选择"}]}}},watch:{show:function(e,t){var s=this;s.visible=e}},methods:{onClose:function(){this.visible.show=!1,this.form.resetFields()},handleSubmit:function(){this.form.validateFields(function(e,t){if(!e){var s=document.createElement("a");s.href="/api/Supplies/Assets/getAssetsOutExport?begindate="+t.DatePicker[0].format("YYYY-MM-DD")+"&enddate="+t.DatePicker[1].format("YYYY-MM-DD"),s.click()}})}}},n=o,i=s("2877"),l=Object(i["a"])(n,a,r,!1,null,null,null);t["default"]=l.exports},f294:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("a-drawer",{attrs:{title:"报废后处置",placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:400}},[s("a-card",{attrs:{bordered:!1}},[s("a-form",{attrs:{form:e.form}},[s("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:10}},[s("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("编号:")]),s("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetstransferdetail.AssetsCode))])],1),s("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:10}},[s("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("名称:")]),s("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetstransferdetail.AssetsName))])],1),s("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:10}},[s("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("品牌:")]),s("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetstransferdetail.BrandName))])],1),s("a-row",{staticStyle:{padding:"8px 0"},attrs:{gutter:10}},[s("a-col",{staticStyle:{"text-align":"right"},attrs:{span:6}},[e._v("规格:")]),s("a-col",{attrs:{span:18}},[e._v(e._s(e.visible.assetstransferdetail.Spec))])],1),s("a-row",{attrs:{gutter:24}},[s("a-col",{attrs:{span:24}},[s("a-form-item",{attrs:{label:"处置类型",labelCol:{span:6},wrapperCol:{span:18}}},[s("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["DisposeType",{rules:e.AFormImportRules.iptSelect}],expression:"['DisposeType',{rules:AFormImportRules.iptSelect}]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.DisposeTypeList,function(t){return s("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1)],1),s("a-col",{attrs:{span:24}},[s("a-form-item",{attrs:{label:"处置日期",labelCol:{span:6},wrapperCol:{span:18}}},[s("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["DisposeDate",{rules:e.AFormImportRules.iptDate}],expression:"['DisposeDate',{rules:AFormImportRules.iptDate }]"}],staticStyle:{width:"100%"}})],1)],1)],1),s("a-row",{attrs:{gutter:24}},[s("a-col",{attrs:{span:24}},[s("a-form-item",{attrs:{label:"说明",labelCol:{span:6},wrapperCol:{span:18}}},[s("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["DisposeNotes",{rules:e.AFormImportRules.iptTextarea}],expression:"['DisposeNotes',{rules:AFormImportRules.iptTextarea }]"}],attrs:{placeholder:"说明",rows:4}})],1)],1)],1)],1)],1),s("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[s("a-button",{on:{click:e.onClose}},[e._v("取消")]),s("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},r=[],o=s("b775"),n={props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null},callback:{type:Function,default:null}},data:function(){return{visible:{show:!1,assetstransferdetail:{AssetsName:""}},form:this.$form.createForm(this),dim:{Departments:[]},options:[],AFormImportRules:{iptDate:[{required:!0,message:"请选择"}],iptSelect:[{required:!0,message:"请选择"}],iptTextarea:[{required:!0,message:"请输入"}],Amount:[{required:!0,message:"请输入"},{validator:this.checkAmount}]},DisposeTypeList:[]}},watch:{show:function(e,t){var s=this;s.visible=e,e.show&&s.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.form.resetFields()},init:function(){var e=this;o["a"].post("/api/Dim/Enum/GetEnum",{Names:["DisposeType"]}).then(function(t){0===t.code&&(e.DisposeTypeList=t.data.DisposeType)}).catch(function(e){console.log(e)})},handleSubmit:function(){var e=this;this.form.validateFields(function(t,s){if(!t){var a=s;a.AssetsGuid=e.visible.id,o["a"].post("/api/Supplies/Assets/Dispose",a).then(function(t){var s=t;s.code>0?e.$message.error(s.msg):(e.onClose(),e.$message.success(s.msg),e.visible.callback&&e.visible.callback())}).catch(function(e){console.log(e)})}})}}},i=n,l=s("2877"),c=Object(l["a"])(i,a,r,!1,null,null,null);t["default"]=c.exports}}]);