(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-56749bbe"],{"1b17":function(e,t,i){},"51c1":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-drawer",{attrs:{title:e.visible.title,placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:450}},[i("a-form",{attrs:{form:e.form}},[i("a-form-item",{attrs:{label:"产品线",labelCol:{span:6},wrapperCol:{span:16}}},["modify"==e.visible.type?[e._v("\n              "+e._s(e.visible.assetsdetail.ProductLineText)+"               \n            ")]:"detailadd"==e.visible.type?[e._v("\n              "+e._s(e.visible.assetsdetail.line.ProductLineText)+"               \n            ")]:[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ComProductLineGuid",{rules:e.AFormImportRules.iptSelectReq}],expression:"['ComProductLineGuid',{rules:AFormImportRules.iptSelectReq }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.ComProductLine,function(t){return i("a-select-option",{key:t.ComProductLineGuid},[e._v(e._s(t.ProductLineText))])}),1)]],2),i("a-form-item",{attrs:{label:"联系人姓名",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Linkman",{initialValue:e.visible.assetsdetail.Linkman,rules:e.AFormImportRules.iptInputReq}],expression:"['Linkman',{initialValue:visible.assetsdetail.Linkman,rules:AFormImportRules.iptInputReq}]"}]})],1),i("a-form-item",{attrs:{label:"手机号码",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Mobile",{initialValue:e.visible.assetsdetail.Mobile,rules:e.AFormImportRules.Mobile}],expression:"['Mobile',{initialValue:visible.assetsdetail.Mobile,rules:AFormImportRules.Mobile}]"}]})],1),i("a-form-item",{attrs:{label:"固定电话",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Tel",{initialValue:e.visible.assetsdetail.Tel,rules:e.AFormImportRules.iptInput}],expression:"['Tel',{initialValue:visible.assetsdetail.Tel,rules:AFormImportRules.iptInput}]"}]})],1),i("a-form-item",{attrs:{label:"邮箱",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Email",{initialValue:e.visible.assetsdetail.Email,rules:e.AFormImportRules.Email}],expression:"['Email',{initialValue:visible.assetsdetail.Email,rules:AFormImportRules.Email}]"}]})],1),i("a-form-item",{attrs:{label:"部门",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Department",{initialValue:e.visible.assetsdetail.Department,rules:e.AFormImportRules.iptInput}],expression:"['Department',{initialValue:visible.assetsdetail.Department,rules:AFormImportRules.iptInput}]"}]})],1),i("a-form-item",{attrs:{label:"职位职务",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["JobTitle",{initialValue:e.visible.assetsdetail.JobTitle,rules:e.AFormImportRules.iptInput}],expression:"['JobTitle',{initialValue:visible.assetsdetail.JobTitle,rules:AFormImportRules.iptInput}]"}]})],1),i("a-form-item",{attrs:{label:"快递地址",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Address",{initialValue:e.visible.assetsdetail.Address,rules:e.AFormImportRules.iptInput}],expression:"['Address',{initialValue:visible.assetsdetail.Address,rules:AFormImportRules.iptInput}]"}]})],1),i("a-form-item",{attrs:{label:"备注",labelCol:{span:6},wrapperCol:{span:16}}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Remarks",{initialValue:e.visible.assetsdetail.Remarks}],expression:"['Remarks',{initialValue:visible.assetsdetail.Remarks}]"}],attrs:{placeholder:"备注",rows:4}})],1)],1),i("div",{style:{position:"absolute",bottom:"0",right:"0",width:"100%",padding:"10px 16px",borderTop:"1px solid #e8e8e8",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[i("a-button",{on:{click:e.onClose}},[e._v("取消")]),i("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},s=[],o=i("b775"),n=i("61f7"),r={components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,assetsdetail:{}},ComProductLine:[],form:this.$form.createForm(this),AFormImportRules:{iptInput:[{message:"请输入"}],iptInputReq:[{required:!0,message:"请输入"}],iptSelect:[{required:!1,message:"请选择"}],iptSelectReq:[{required:!0,message:"请选择"}],Mobile:[{required:!1,message:"请输入手机号"},{validator:this.ConfirmMobile}],Email:[{message:"请输入邮箱"},{validator:this.ConfirmEmail}]}}},watch:{show:function(e,t){var i=this;i.visible=e,e.show&&i.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.form.resetFields()},init:function(){var e=this,t="";"add"==e.visible.type&&(t=e.visible.assetsdetail.company.ComGuid,o["a"].post("/api/Crm/ProductLine/ListByCom",{ComGuid:t,Scene:"我的",pageSize:50,current:1,total:0}).then(function(t){0===t.code&&(e.ComProductLine=t.data.rows)}).catch(function(e){console.log(e)}))},handleSubmit:function(e){var t=this;this.form.validateFields(function(e,i){if(!e){var a=i,s="";"modify"==t.visible.type&&(a.ComContactGuid=t.visible.assetsdetail.ComContactGuid,a.ComGuid=t.visible.assetsdetail.ComGuid,a.ComProductLineGuid=t.visible.assetsdetail.ComProductLineGuid,s="/api/Crm/Contact/Modify"),"add"!=t.visible.type&&"detailadd"!=t.visible.type||(a.ComGuid=t.visible.assetsdetail.company.ComGuid,s="/api/Crm/Contact/Add"),"detailadd"==t.visible.type&&(a.ComProductLineGuid=t.visible.assetsdetail.line.ComProductLineGuid),t.$loading.open(),o["a"].post(s,a).then(function(e){t.$loading.close();var i=e;i.code>0?t.$message.error(i.msg):(t.refresh&&t.refresh(),t.onClose(),t.$message.success(i.msg))}).catch(function(e){t.$loading.close(),console.log(e)})}})},ConfirmEmail:function(e,t,i){!t||Object(n["b"])(t)?i():i("邮箱不符合规则！")}}},l=r,c=i("2877"),d=Object(c["a"])(l,a,s,!1,null,null,null);t["default"]=d.exports},"51d9":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-drawer",{attrs:{title:"新建沟通记录",placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:400}},[i("a-card",{attrs:{bordered:!1}},[i("a-form",{attrs:{form:e.form}},[i("a-form-item",{attrs:{label:"产品线",labelCol:{span:8},wrapperCol:{span:16}}},["detailadd"==e.visible.type?[e._v("\n          "+e._s(e.visible.assetsdetail.line.ProductLineText)+"               \n        ")]:[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ComProductLineGuids",{rules:e.AFormImportRules.iptSelect}],expression:"['ComProductLineGuids',{rules:AFormImportRules.iptSelect}]"}],attrs:{mode:"multiple",placeholder:"请选择",allowClear:!0,"default-value":e.visible.connectdetail.ComProductLineGuids}},e._l(e.ComProductLine,function(t){return i("a-select-option",{key:t.ComProductLineGuid},[e._v(e._s(t.ProductLineText))])}),1)]],2),i("a-form-item",{attrs:{label:"联系人",labelCol:{span:8},wrapperCol:{span:16}}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ComContactGuid",{initialValue:e.visible.connectdetail.ComContactGuid,rules:e.AFormImportRules.iptSelect}],expression:"['ComContactGuid',{initialValue:visible.connectdetail.ComContactGuid,rules:AFormImportRules.iptSelect }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.linkmanList,function(t){return i("a-select-option",{key:t.ComContactGuid},[e._v(e._s(t.Linkman))])}),1)],1),i("a-form-item",{attrs:{label:"联系方式",labelCol:{span:8},wrapperCol:{span:16}}},[i("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["ContactType",{rules:e.AFormImportRules.iptSelect}],expression:"['ContactType',{rules:AFormImportRules.iptSelect }]"}],attrs:{placeholder:"请选择",allowClear:!0}},e._l(e.dim.ContactType,function(t){return i("a-select-option",{key:t.key},[e._v(e._s(t.text))])}),1)],1),i("a-form-item",{attrs:{label:"联系内容",labelCol:{span:8},wrapperCol:{span:16}}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["ContactContent",{rules:e.AFormImportRules.iptInput}],expression:"['ContactContent',{rules:AFormImportRules.iptInput}]"}],attrs:{placeholder:"请输入联系内容",rows:4}})],1),i("a-form-item",{attrs:{label:"下次联系时间",labelCol:{span:8},wrapperCol:{span:16}}},[i("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["NextContacttime"],expression:"['NextContacttime']"}],attrs:{"show-time":"",format:"YYYY-MM-DD HH:mm:ss"}})],1)],1)],1),i("div",{style:{position:"absolute",bottom:0,width:"100%",borderTop:"1px solid #e8e8e8",padding:"10px 16px",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[i("a-button",{on:{click:e.onClose}},[e._v("取消")]),i("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")]),null==e.visible.id?i("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleSubmit("next")}}},[e._v("提交并继续录入")]):e._e()],1)],1)},s=[],o=i("b775"),n=(i("61f7"),{props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,assetsdetail:{},connectdetail:{ComProductLineGuid:"",ComContactGuid:""}},dim:{Brand:[]},ComProductLine:[],DepList:[],linkmanList:[],form:this.$form.createForm(this),AFormImportRules:{iptDate:[{required:!0,message:"请选择"}],iptInput:[{required:!0,message:"请输入"}],iptSelect:[{required:!0,message:"请选择"}],Mobile:[{required:!0,message:"请输入手机号"},{validator:this.ConfirmMobile}]}}},watch:{show:function(e,t){var i=this;i.visible=e,e.show&&i.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.form.resetFields()},init:function(){var e=this;o["a"].post("/api/Dim/Enum/GetEnum",{Names:["ContactType"]}).then(function(t){0===t.code&&(e.dim.ContactType=t.data.ContactType)}).catch(function(e){console.log(e)}),o["a"].post("/api/Crm/Contact/List",{ComGuid:e.visible.assetsdetail.company.ComGuid,pageSize:50,current:1,total:0}).then(function(t){0===t.code&&(e.linkmanList=t.data.rows)}).catch(function(e){console.log(e)}),o["a"].post("/api/Crm/ProductLine/ListByCom",{ComGuid:e.visible.assetsdetail.company.ComGuid,Scene:"我的",pageSize:50,current:1,total:0}).then(function(t){0===t.code&&(e.ComProductLine=t.data.rows)}).catch(function(e){console.log(e)})},handleSubmit:function(e){var t=this;this.form.validateFields(function(i,a){if(!i){var s=a;s.ComGuid=t.visible.assetsdetail.company.ComGuid,"detailadd"==t.visible.type&&(s.ComProductLineGuids=[],s.ComProductLineGuids.push(t.visible.assetsdetail.line.ComProductLineGuid)),t.$loading.open(),o["a"].post("/api/Crm/Contact/AddRecord",s).then(function(i){t.$loading.close();var a=i;a.code>0?t.$message.error(a.msg):("next"===e?(t.form.resetFields(),t.refresh&&t.refresh()):t.onClose(),t.$message.success(a.msg))}).catch(function(e){t.$loading.close(),console.log(e)})}})}}}),r=n,l=i("2877"),c=Object(l["a"])(r,a,s,!1,null,null,null);t["default"]=c.exports},"6e63":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-drawer",{attrs:{title:"修改产品线信息",placement:"right",closable:!1,maskClosable:!1,visible:this.visible.show,width:400}},[i("a-form",{attrs:{form:e.form}},[i("a-form-item",{attrs:{label:"产品线",labelCol:{span:5},wrapperCol:{span:16}}},[e._v("\n            "+e._s(e.visible.assetsdetail.ProductLineText)+"\n          ")]),i("a-form-item",{attrs:{label:"部门",labelCol:{span:5},wrapperCol:{span:16}}},[e._v("\n            "+e._s(e.visible.assetsdetail.DepIdText)+"\n          ")]),i("a-form-item",{attrs:{label:"预算",labelCol:{span:5},wrapperCol:{span:16}}},[i("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["Budget",{initialValue:e.visible.assetsdetail.Budget,rules:e.AFormImportRules.iptInput}],expression:"['Budget',{initialValue:visible.assetsdetail.Budget,rules:AFormImportRules.iptInput}]"}]})],1),i("a-form-item",{attrs:{label:"备注",labelCol:{span:5},wrapperCol:{span:16}}},[i("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["Remarkspro",{initialValue:e.visible.assetsdetail.Remarks}],expression:"['Remarkspro',{initialValue:visible.assetsdetail.Remarks}]"}],attrs:{placeholder:"备注",rows:4}})],1)],1),i("div",{style:{position:"absolute",bottom:"0",right:"0",width:"100%",padding:"10px 16px",borderTop:"1px solid #e8e8e8",textAlign:"right",left:0,background:"#fff",borderRadius:"0 0 4px 4px"}},[i("a-button",{on:{click:e.onClose}},[e._v("取消")]),i("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit"},on:{click:e.handleSubmit}},[e._v("提交")])],1)],1)},s=[],o=i("b775"),n=i("61f7"),r={components:{},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null}},data:function(){return{visible:{show:!1,assetsdetail:{company:{},line:{}}},dim:{Brand:[]},DepList:[],form:this.$form.createForm(this),AFormImportRules:{iptInput:[{required:!1,message:"请输入"},{validator:this.ConfirmNumber}],iptInputReq:[{required:!0,message:"请输入"}],iptSelect:[{required:!1,message:"请选择"}],iptSelectReq:[{required:!0,message:"请选择"}]}}},watch:{show:function(e,t){var i=this;i.visible=e,null==i.visible.assetsdetail&&(i.visible.assetsdetail={ComGuid:""}),e.show&&i.init()}},methods:{onClose:function(){this.visible.show=!1,this.refresh&&this.refresh(),this.form.resetFields()},init:function(){var e=this;o["a"].get("/api/Org/Department/DepsByCurUser").then(function(t){0===t.code&&(e.DepList=t.data)}).catch(function(e){console.log(e)}),o["a"].post("/api/Dim/Enum/GetEnum",{Names:["ComProductLine"]}).then(function(t){0===t.code&&(e.dim.ComProductLine=t.data.ComProductLine)}).catch(function(e){console.log(e)})},ConfirmNumber:function(e,t,i){!t||Object(n["c"])(t)?i():i("请输入数字！")},handleSubmit:function(e){var t=this;this.form.validateFields(function(e,i){if(!e){var a={comProductLine:{ComGuid:t.visible.assetsdetail.ComGuid,ComProductLineGuid:t.visible.assetsdetail.ComProductLineGuid,ProductLine:t.visible.assetsdetail.ProductLine,DepId:t.visible.assetsdetail.DepId,Budget:i.Budget,Remarks:i.Remarkspro}};t.$loading.open(),o["a"].post("/api/Crm/ProductLine/Modify",a).then(function(e){t.$loading.close();var i=e;i.code>0?t.$message.error(i.msg):(t.onClose(),t.$message.success(i.msg))}).catch(function(e){t.$loading.close(),console.log(e)})}})}}},l=r,c=i("2877"),d=Object(c["a"])(l,a,s,!1,null,null,null);t["default"]=d.exports},c0c8:function(e,t,i){"use strict";var a=i("1b17"),s=i.n(a);s.a},fbff:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("a-drawer",{attrs:{message:"",visible:this.visible.show,width:750,destroyOnClose:!0,closable:!1},on:{close:e.onClose}},[i("template",{slot:"title"},[e._v("\n    详情\n    "),0==e.assetsdetail.line.Opened&&e.visible.userid==e.visible.assetsdetail.Userid?i("a-button",{staticStyle:{float:"right"},attrs:{size:"small",icon:"form"},on:{click:e.modify}},[e._v("修改")]):e._e(),0==e.assetsdetail.line.Opened&&e.visible.userid==e.visible.assetsdetail.Userid?i("a-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"small",icon:"delete"},on:{click:e.throwLine}},[e._v("放弃")]):e._e(),1==e.assetsdetail.line.Opened?i("a-button",{staticStyle:{float:"right","margin-right":"10px"},attrs:{size:"small",icon:"pushpin"},on:{click:e.claimLine}},[e._v("认领")]):e._e()],1),i("comDetailText",{attrs:{assetsdetail:e.assetsdetail}}),i("div",{staticStyle:{"border-top":"1px dashed #ddd"}}),i("lineDetailText",{attrs:{assetsdetail:e.assetsdetail}}),i("a-row",{staticStyle:{padding:"10px 0"},attrs:{gutter:24}}),i("div",[i("a-tabs",{attrs:{type:"card",defaultActiveKey:"1"},on:{change:e.callback}},[i("a-tab-pane",{key:"1",attrs:{tab:"沟通记录"}},[i("a-row",{attrs:{gutter:10}},[i("a-col",{attrs:{span:24}},[i("a-form-item",[i("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.connectAdd()}}},[e._v("添加")])],1)],1)],1),e.sourceListRecords.length>0?[i("a-timeline",[e._l(e.sourceListRecords,function(t){return i("a-timeline-item",{key:t.index},[i("p",[e._v(e._s(t.Contacttime)+" "),i("a-divider",{attrs:{type:"vertical"}}),e._v(" "+e._s(t.UseridText)+"  "),i("a-divider",{attrs:{type:"vertical"}}),e._v(" "+e._s(t.ContactTypeText)+"沟通  "),i("a-divider",{attrs:{type:"vertical"}}),e._v(" "+e._s(t.ProductLineText))],1),i("p",[e._v("沟通内容："+e._s(t.ContactContent))])])}),i("a-timeline-item",[i("a",{directives:[{name:"show",rawName:"v-show",value:1==e.formSearch.next,expression:"formSearch.next==true"}],on:{click:e.loadMore}},[e._v("查看更多")]),i("span",{directives:[{name:"show",rawName:"v-show",value:0==e.formSearch.next,expression:"formSearch.next==false"}]},[i("a-icon",{attrs:{type:"smile"}}),e._v(" 我是有底线的")],1)])],2)]:e._e(),0==e.sourceListRecords.length?[i("div",[i("a-row",{staticStyle:{"text-align":"center"}},[i("a-icon",{attrs:{type:"smile"}}),e._v(" 暂无数据")],1)],1)]:e._e()],2),i("a-tab-pane",{key:"3",attrs:{tab:"合同"}},[i("contractList",{attrs:{assetsdetail:e.assetsdetail,componenttype:e.line,userid:e.visible.userid},on:{refresh:e.init}})],1),i("a-tab-pane",{key:"4",attrs:{tab:"联系人"}},[i("a-row",{attrs:{gutter:10}},[i("a-col",{attrs:{span:24}},[i("a-form-item",[i("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:function(t){return e.linkAdd()}}},[e._v("添加")])],1)],1)],1),e.linkmanList.length>0?i("a-row",{attrs:{gutter:24}},e._l(e.linkmanList,function(t){return i("a-col",{key:t.ComContactGuid,attrs:{span:12}},[i("a-row",{staticClass:"linkman"},[i("a-col",{staticClass:"acol",attrs:{span:8}},[i("a-icon",{attrs:{type:"user"}}),e._v(" "+e._s(t.Linkman))],1),i("a-col",{staticClass:"acol",attrs:{span:16,align:"right"}},[i("a-icon",{attrs:{type:"phone"}}),e._v(e._s(t.Mobile)+" "),t.Tel&&t.Mobile?i("span",[e._v("/")]):e._e(),e._v(" "+e._s(t.Tel)+" "),t.Tel||t.Mobile?e._e():i("span",[e._v("没有联系方式")])],1),i("a-col",{staticClass:"acol",attrs:{span:10}},[e._v(e._s(t.ProductLineText))]),i("a-col",{staticClass:"acol",attrs:{span:14,align:"right"}},[e._v(e._s(t.Department)+" "),t.Department&&t.JobTitle?i("span",[e._v("/")]):e._e(),e._v(" "+e._s(t.JobTitle))]),i("a-col",{staticClass:"acol",attrs:{span:24}},[i("a",{on:{click:function(i){return e.linkDetail(t)}}},[e._v("详情")]),e._v(" | "),i("a",{on:{click:function(i){return e.linkModify(t)}}},[e._v("修改")]),e._v(" | "),i("a",{on:{click:function(i){return e.linkDelete(t)}}},[e._v("弃用")]),e._v(" | "),i("a",{on:{click:function(i){return e.connectAddLink(t)}}},[e._v("添加沟通记录")])])],1)],1)}),1):i("a-row",[i("a-col",{attrs:{align:"center"}},[i("a-icon",{attrs:{type:"smile"}}),e._v(" 暂无联系人")],1)],1),e.linkmanList.length>0?i("a-pagination",{staticStyle:{float:"right"},attrs:{defaultCurrent:1,pageSize:e.linkTable.pageSize,total:e.linkTable.total,current:e.linkTable.current},on:{change:e.linkmanListChange}}):e._e()],1)],1)],1),i("a-modal",{attrs:{title:"提示信息",visible:e.showClaimLayer,"confirm-loading":e.confirmLoading},on:{ok:e.handleOk,cancel:e.handleCancel}},[i("a-form",{attrs:{layout:"horizontal"}},[i("div",[i("a-row",{attrs:{gutter:10}},[i("a-col",{attrs:{md:24}},[i("a-form-item",{attrs:{label:"所属部门",labelCol:{span:5},wrapperCol:{span:18,offset:1}}},[i("a-select",{model:{value:e.departmentKey,callback:function(t){e.departmentKey=t},expression:"departmentKey"}},e._l(e.department,function(t){return i("a-select-option",{key:t.code},[e._v("\n                      "+e._s(t.name)+"\n                    ")])}),1)],1)],1)],1)],1)])],1),i("drawer-edit",{attrs:{show:e.drawer.edit,refresh:e.init}}),i("drawer-connect-add",{attrs:{show:e.drawer.connectAdd,refresh:e.init}}),i("drawer-link-modify",{attrs:{show:e.drawer.linkmodify,refresh:e.initLink}}),i("drawer-link-detail",{attrs:{show:e.drawer.linkdetail,refresh:e.initLink}}),i("drawer-line-modify",{attrs:{show:e.drawer.linemodify,assetsdetail:{},refresh:e.init}})],2)},s=[],o=i("b775"),n=i("7e7e"),r=(i("c32d"),i("51d9")),l=i("51c1"),c=i("3443"),d=i("6e63"),u=i("1663"),m=i("143b"),p=i("7c3a"),h=[{title:"产品线",dataIndex:"ProductLineText",width:100},{title:"销售姓名",dataIndex:"UseridText",width:90},{title:"沟通方式",dataIndex:"ContactTypeText",width:90},{title:"沟通时间",dataIndex:"Contacttime",width:210},{title:"操作",scopedSlots:{customRender:"action"}}],f={components:{DrawerEdit:n["default"],DrawerConnectAdd:r["default"],DrawerLinkModify:l["default"],DrawerLinkDetail:c["default"],DrawerLineModify:d["default"],contractList:u["default"],comDetailText:m["a"],lineDetailText:p["a"]},props:{show:{type:Object,default:{show:!1}},refresh:{type:Function,default:null},deleteLine:{type:Function,default:null}},data:function(){return{visible:{show:!1,id:{},listText:{}},line:"line",showClaimLayer:!1,columnsconnect:h,formSearch:{pageSize:5,current:1,total:0,next:!0},linkTable:{pageSize:5,current:1,total:0},sourceListRecords:[],linkmanList:[],assetsdetail:{ComName:"",company:{},line:{},leads:{}},enableeditguid:"",form:this.$form.createForm(this),drawer:{edit:{show:!1},connectAdd:{show:!1},linkmodify:{show:!1},linkdetail:{show:!1},linemodify:{show:!1}},modal:{outchange:{show:!1}},confirmLoading:!1,department:[],departmentKey:"",checkLineId:"",rankText:""}},created:function(){var e=this;this.$watch("show",function(t,i){e.visible=t,e.visible.show&&e.init()})},methods:{init:function(){var e=this;o["a"].post("/api/Crm/ProductLine/Detail",{ComProductLineGuid:e.visible.assetsdetail.ComProductLineGuid}).then(function(t){0===t.code&&(e.assetsdetail=t.data,e.assetsdetail.ComName=t.data.company.ComName,e.sourceListRecords=[],e.formSearch.next=!0,e.pagechange(1),e.rank())}).catch(function(e){console.log(e)})},onClose:function(){this.visible.show=!1,this.sourceListRecords=[],this.formSearch.next=!0,this.assetsdetail={company:{},line:{},leads:{}},this.refresh&&this.refresh()},detail:function(e){this.drawer.detail={show:!0,id:e.SBOrderItemGuid}},edit:function(){this.drawer.edit={show:!0,id:this.show.id,assetsdetail:this.assetsdetail}},modify:function(){this.drawer.linemodify={show:!0,id:this.show.id,assetsdetail:this.assetsdetail.line}},throwLine:function(){var e=this;e.deleteLine(this.visible.assetsdetail)},outchange:function(e){this.modal.outchange={show:!0,id:e.BalanceGuid,balance:e}},callback:function(e){4==e&&this.linkmanListChange(1)},loadMore:function(){this.formSearch.current=this.formSearch.current+1,this.pagechange(this.formSearch.current)},pagechange:function(e){var t=this,i=t.formSearch;t.formSearch.current=e,i.ComGuid=t.assetsdetail.company.ComGuid,i.ComProductLineGuid=t.assetsdetail.line.ComProductLineGuid,o["a"].post("/api/Crm/Contact/ListRecords",i).then(function(e){0===e.code&&(t.sourceListRecords=t.sourceListRecords.concat(e.data.rows),t.formSearch.total=e.count,e.data.rows.length<t.formSearch.pageSize&&(t.formSearch.next=!1))}).catch(function(e){console.log(e)})},initLink:function(){this.linkmanListChange(1)},linkmanListChange:function(e){var t=this,i=t.linkTable;t.linkTable.current=e,i.ComGuid=t.assetsdetail.company.ComGuid,i.ComProductLineGuid=t.assetsdetail.line.ComProductLineGuid,o["a"].post("/api/Crm/Contact/List",i).then(function(e){0===e.code&&(t.linkmanList=e.data.rows,t.linkTable.total=e.count)}).catch(function(e){console.log(e)})},connectAdd:function(){this.drawer.connectAdd={show:!0,assetsdetail:this.assetsdetail,type:"detailadd",connectdetail:{}}},connectAddLink:function(e){this.drawer.connectAdd={show:!0,assetsdetail:this.assetsdetail,type:"detailadd",connectdetail:e}},linkAdd:function(){this.drawer.linkmodify={show:!0,assetsdetail:this.assetsdetail,type:"detailadd",title:"新增联系人"}},linkModify:function(e){this.drawer.linkmodify={show:!0,assetsdetail:e,type:"modify",title:"修改联系人"}},linkDetail:function(e){this.drawer.linkdetail={show:!0,assetsdetail:e}},linkDelete:function(e){var t=this;t.$confirm({title:"确定弃用该联系人?",content:"点击确定弃用联系人。",onOk:function(){o["a"].post("/api/Crm/Contact/Throw",{ComContactGuid:e.ComContactGuid}).then(function(e){0===e.code?(t.$message.success(e.msg),t.initLink()):t.$message.error(e.msg)}).catch(function(e){console.log(e)})},onCancel:function(){}})},claimLine:function(){var e=this;e.showClaimLayer=!0,o["a"].get("/api/Org/Department/DepsByCurUser").then(function(t){0===t.code&&(e.department=t.data)}).catch(function(e){console.log(e)}),e.checkLineId=e.assetsdetail.line.ComProductLineGuid},handleOk:function(e){var t=this;t.departmentKey?o["a"].post("/api/Crm/ProductLine/Pick",{ComProductLineGuid:t.checkLineId,DepId:t.departmentKey}).then(function(e){0===e.code&&(t.showClaimLayer=!1,t.$message.success(e.msg),t.departmentKey="",t.checkLineId="",t.init(),t.refresh()),e.code>0&&t.$message.error(e.msg)}).catch(function(e){console.log(e)}):t.$message.error("请选择你的所属部门！")},handleCancel:function(e){this.showClaimLayer=!1,this.checkLineId=""},rank:function(){var e=this;o["a"].post("/api/Crm/ComRank/Last",{ComGuid:e.assetsdetail.company.ComGuid}).then(function(t){0===t.code&&(t.data?e.rankText=e.visible.comRankObject[t.data.Rank]:e.rankText="")}).catch(function(e){console.log(e)})}}},v=f,b=(i("c0c8"),i("2877")),C=Object(b["a"])(v,a,s,!1,null,null,null);t["default"]=C.exports}}]);